<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>GCC-RISCV交叉编译工具链 | CodeSaw</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  <link rel="stylesheet" href="/css/style.css">
  
    <link rel="stylesheet" href="/css/highlight.css">
  
  <meta name="description" content="Absrtact  旨在x86平台上编译RISCV架构的可执行文件。 RISCV作为一款极具使命感的指令集，其软件栈也是非常完整的。交叉编译环境可以在这里下载。 交叉编译工具链包括:  GCC编译器 C运行库  Glibc : gnu旗下的库，作为linux的标准库和内核打交道 Newlib： 在嵌入式中使用广泛  Buntils二进制套件 GDB调试器">
<meta name="keywords" content="RISCV,Compiler">
<meta property="og:type" content="article">
<meta property="og:title" content="GCC-RISCV交叉编译工具链">
<meta property="og:url" content="http://haotianmcihael.github.io/2020/02/16/Gcc-RISCV交叉编译工具链/index.html">
<meta property="og:site_name" content="CodeSaw">
<meta property="og:description" content="Absrtact  旨在x86平台上编译RISCV架构的可执行文件。 RISCV作为一款极具使命感的指令集，其软件栈也是非常完整的。交叉编译环境可以在这里下载。 交叉编译工具链包括:  GCC编译器 C运行库  Glibc : gnu旗下的库，作为linux的标准库和内核打交道 Newlib： 在嵌入式中使用广泛  Buntils二进制套件 GDB调试器">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://haotianmcihael.github.io/2020/02/16/Gcc-RISCV交叉编译工具链/1.png">
<meta property="og:image" content="http://haotianmcihael.github.io/2020/02/16/Gcc-RISCV交叉编译工具链/2.png">
<meta property="og:updated_time" content="2020-06-26T02:52:19.865Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="GCC-RISCV交叉编译工具链">
<meta name="twitter:description" content="Absrtact  旨在x86平台上编译RISCV架构的可执行文件。 RISCV作为一款极具使命感的指令集，其软件栈也是非常完整的。交叉编译环境可以在这里下载。 交叉编译工具链包括:  GCC编译器 C运行库  Glibc : gnu旗下的库，作为linux的标准库和内核打交道 Newlib： 在嵌入式中使用广泛  Buntils二进制套件 GDB调试器">
<meta name="twitter:image" content="http://haotianmcihael.github.io/2020/02/16/Gcc-RISCV交叉编译工具链/1.png"></head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1 id="title">
    <a href="/">CodeSaw</a>
  </h1>
  <nav>
    
    
      
      <a class="nav-link" href="/">Home</a>
    
      
        <span class="nav-spacer">×</span>
      
      <a class="nav-link" href="/archives">Archives</a>
    
    
  </nav>
</header>

    <div id="content">
      <article id="post-Gcc-RISCV交叉编译工具链" class="article article-type-post" itemprop="blogPost" itemscope>
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 class="article-title" itemprop="headline name">
      GCC-RISCV交叉编译工具链
    </h2>
  


        <div class="article-meta">
          <time class="article-date" datetime="2020-02-15T18:16:45.000Z" itemprop="datePublished">2020-02-15</time>

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
      
        <h3 id="absrtact">Absrtact</h3>
<blockquote>
<p>旨在x86平台上编译RISCV架构的可执行文件。</p>
<p>RISCV作为一款极具使命感的指令集，其软件栈也是非常完整的。交叉编译环境可以在<a href="https://github.com/riscv/riscv-gnu-toolchain" target="_blank" rel="noopener">这里</a>下载。</p>
<p>交叉编译工具链包括:</p>
<ul>
<li><code>GCC</code>编译器</li>
<li>C运行库
<ul>
<li><code>Glibc</code> : <code>gnu</code>旗下的库，作为<code>linux</code>的标准库和内核打交道</li>
<li><code>Newlib</code>： 在嵌入式中使用广泛</li>
</ul></li>
<li><code>Buntils</code>二进制套件</li>
<li><code>GDB</code>调试器</li>
</ul>
</blockquote>
<a id="more"></a>
<h3 id="不同版本的工具链">不同版本的工具链</h3>
<table>
<thead>
<tr class="header">
<th>Version</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Riscv-unknown-linux-gnu-gcc</td>
<td><sup>1</sup>32位架构的<sup>2</sup><strong>Linux版本</strong></td>
</tr>
<tr class="even">
<td>Riscv-unknown-elf-gcc</td>
<td>32位架构的<strong>非Linux版本</strong></td>
</tr>
</tbody>
</table>
<ul>
<li>每个版本都有32位架构和64位架构，这里的位数和运行本机的字长无关，<strong>指的是没有通过<code>-march=</code>和<code>-mabi=</code>选项指定RISCV架构的位宽</strong></li>
<li><strong>Linux版本</strong>指的是<strong>该工具链使用Linux系统中运行的<code>Glibc</code>作为C运行库——</strong>另外的个版本则使用<code>Newlibc</code>库</li>
</ul>
<h3 id="交叉编译选项">交叉编译选项</h3>
<h4 id="march">-march=</h4>
<p>​ 由于<span class="math inline">\(RISCV\)</span>为模块化指令，该选项支持不同的模块化指令集组合,关于<span class="math inline">\(RISCV\)</span>模块见后面的介绍:</p>
<ul>
<li><code>rv32i[m][a][f[d]][c]</code></li>
<li><code>rv32g[c]</code></li>
<li><code>rv64i[m][a][f[d]][c]</code></li>
<li><code>rv64g[c]</code></li>
</ul>
<h4 id="mabi">-mabi=</h4>
<p>​ 该选项选定了目标平台所支持的<code>ABI</code>函数调用:</p>
<ul>
<li><code>ilp32</code>，<code>ilp32f</code>，<code>ilp32d</code> 32位架构(int-32位 long-32位 long long-64位)</li>
<li><code>lp64</code>，<code>lp64f</code>，<code>lp64d</code> 64位架构(int-32位 long-64位)</li>
</ul>
<h4 id="后缀">后缀</h4>
<table>
<thead>
<tr class="header">
<th>suffix</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>--</td>
<td>使用浮点类型操作直接使用RISCV浮点指令进行支持，但是当浮点数作为函数参数进行传递时，无论是单精度还是双精度均需要存储器中的堆栈进行传递</td>
</tr>
<tr class="even">
<td>-f</td>
<td>使用浮点类型操作直接使用RISCV浮点指令进行支持，但是当浮点数作为函数参数进行传递时，单精度通过寄存拿起传递，双精度通过内存堆栈传递</td>
</tr>
<tr class="odd">
<td>-d</td>
<td>使用浮点类型操作直接使用RISCV浮点指令进行支持，但是当浮点数作为函数参数进行传递时，单/双精度均可通过寄存器传递</td>
</tr>
</tbody>
</table>
<p><strong>只有<code>-march=</code>支持浮点扩展，(-mabi=)才允许加上<code>f/d</code>后缀以支持浮点运算。</strong></p>
<p><img src="1.png" width="50%" height="50%" alt=""></p>
<h3 id="riscv汇编语言简介">RISCV汇编语言简介</h3>
<p><img src="2.png" width="50%" height="50%" alt=""></p>
<h3 id="总结">总结</h3>
<blockquote>
<p>目前交叉编译平台主要有两部分: <code>riscv32-unknown-elf-gcc</code>平台编译生成<span class="math inline">\(RISCV\)</span>可执行文件，而<code>qemu-riscv32</code>平台运行<code>RISCV</code>可执行文件。</p>
<p><code>qemu</code>是一款很强大的虚拟机，分为系统模式和用户模式，用户模式运行可执行文件，而系统模式模拟特定指令集从而运行操作系统镜像文件。</p>
</blockquote>

      
    </div>
    
    
    <div class="article-category">
      
        <b>Categories:</b>
        <a class="article-category-link" href="/categories/Assembly/">Assembly</a>
      
      
        <br/>
      
      
        <b>Tags:</b>
        <a class="article-tag-link" href="/tags/Compiler/">Compiler</a>, <a class="article-tag-link" href="/tags/RISCV/">RISCV</a>
      
    </div>
    
    
  </div>
</article>

  
<nav id="article-nav" class="article-nav">
  
    <a href="/2020/06/02/LLVM漫谈（0-编译系统概述）/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          LLVM漫谈（0-编译系统概述）
        
      </div>
    </a>
  
  
    <a href="/2019/06/25/从syscall的角度理解操作系统/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          从syscall的角度理解操作系统
        
      </div>
    </a>
  
</nav>






    </div>
  </div>
  




<div id="settings-container">
  <div id="dark-mode">dark</div>
  <div id="sans-font">sans</div>
</div>
<script type="text/javascript">
let d=document,r=d.documentElement.style,f=r.setProperty.bind(r),l=localStorage,s=l.getItem('s')||(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches),n=l.getItem('n'),m=d.getElementById("dark-mode"),b=()=>{f('--bg-color','#fafafa');f('--code-bg-color','#f4f4f4');f('--text-color','#212121');f('--secondary-color','#808080');f('--tertiary-color','#b0b0b0');f('--link-color','#b5c8cf');f('--link-hover-color','#618794');f('--link-bg-color','#dae4e7');f('--selection-color','#dae4e7');m.innerHTML="dark"},c=()=>{f('--bg-color','#212121');f('--code-bg-color','#292929');f('--text-color','#fff');f('--secondary-color','#c0c0c0');f('--tertiary-color','#6e6e6e');f('--link-color','#4d6b75');f('--link-hover-color','#96b1bb');f('--link-bg-color','#5d828e');f('--selection-color','#acc1c9');m.innerHTML="light"},o=d.getElementById("sans-font"),e=()=>{f('--body-stack','"Lora", "Georgia", "Times New Roman", serif');o.innerHTML="sans"},g=()=>{f('--body-stack','"Lato", "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", "Verdana", sans-serif');o.innerHTML="serif"};m.onclick=()=>{if(s==2){s=1;l.setItem('s',s);c()}else{s=2;l.setItem('s',s);b()}};o.onclick=()=>{if(n==2){n=1;l.setItem('n',n);g()}else{n=2;l.setItem('n',n);e()}};if(!s){s=2;l.setItem('s',2)};if(s==1){c()};if(!n){n=2;l.setItem('n',2)};if(n==1){g()};
</script>




<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->
<!--<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->

</body>
</html>
