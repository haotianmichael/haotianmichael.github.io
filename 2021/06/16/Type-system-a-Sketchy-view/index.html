<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />





  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "5d4a5755"
    });
  daovoice('update');
  </script>















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="PL,Type System," />





  <link rel="alternate" href="/atom.xml" title="CodeSaw" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.2" />






<meta name="description" content="Abstract Type systemçš„åŸºæœ¬ç›®çš„æ˜¯é˜²æ­¢åœ¨ç¨‹åºè¿è¡Œæ—¶å‘ç”Ÿexecution errorã€‚è¿™ç§Informal statementéå½¢å¼åŒ–æè¿°æœ‰å¾ˆå¤šå†…æ¶µï¼šé¦–å…ˆè¯¥å¦‚ä½•ä¸¥æ ¼å®šä¹‰execution errorï¼›å…¶æ¬¡åœ¨è¿™ç§å®šä¹‰ä¸‹ï¼Œæè¿°absence of execution errorä¹Ÿæ˜¯Type systemå¾ˆnontrivialçš„æ€§è´¨â€”â€”å½“PL .aka. programming lan">
<meta name="keywords" content="PL,Type System">
<meta property="og:type" content="article">
<meta property="og:title" content="Type system, a Sketchy view.">
<meta property="og:url" content="http://haotianmcihael.github.io/2021/06/16/Type-system-a-Sketchy-view/index.html">
<meta property="og:site_name" content="CodeSaw">
<meta property="og:description" content="Abstract Type systemçš„åŸºæœ¬ç›®çš„æ˜¯é˜²æ­¢åœ¨ç¨‹åºè¿è¡Œæ—¶å‘ç”Ÿexecution errorã€‚è¿™ç§Informal statementéå½¢å¼åŒ–æè¿°æœ‰å¾ˆå¤šå†…æ¶µï¼šé¦–å…ˆè¯¥å¦‚ä½•ä¸¥æ ¼å®šä¹‰execution errorï¼›å…¶æ¬¡åœ¨è¿™ç§å®šä¹‰ä¸‹ï¼Œæè¿°absence of execution errorä¹Ÿæ˜¯Type systemå¾ˆnontrivialçš„æ€§è´¨â€”â€”å½“PL .aka. programming lan">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://haotianmcihael.github.io/2021/06/16/Type-system-a-Sketchy-view/1.png">
<meta property="og:updated_time" content="2022-03-20T21:39:18.045Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Type system, a Sketchy view.">
<meta name="twitter:description" content="Abstract Type systemçš„åŸºæœ¬ç›®çš„æ˜¯é˜²æ­¢åœ¨ç¨‹åºè¿è¡Œæ—¶å‘ç”Ÿexecution errorã€‚è¿™ç§Informal statementéå½¢å¼åŒ–æè¿°æœ‰å¾ˆå¤šå†…æ¶µï¼šé¦–å…ˆè¯¥å¦‚ä½•ä¸¥æ ¼å®šä¹‰execution errorï¼›å…¶æ¬¡åœ¨è¿™ç§å®šä¹‰ä¸‹ï¼Œæè¿°absence of execution errorä¹Ÿæ˜¯Type systemå¾ˆnontrivialçš„æ€§è´¨â€”â€”å½“PL .aka. programming lan">
<meta name="twitter:image" content="http://haotianmcihael.github.io/2021/06/16/Type-system-a-Sketchy-view/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://haotianmcihael.github.io/2021/06/16/Type-system-a-Sketchy-view/"/>






  <title>Type system, a Sketchy view. | CodeSaw</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>
    <a href="https://github.com/haotianmichael" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">CodeSaw</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-algorithm">
          <a href="/algorithm/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-desktop"></i> <br />
            
            Algorithm
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://haotianmcihael.github.io/2021/06/16/Type-system-a-Sketchy-view/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HaotianMichael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CodeSaw">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Type system, a Sketchy view.</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-06-15T18:02:32Z">
                2021-06-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ğ›Œ-calculus/" itemprop="url" rel="index">
                    <span itemprop="name">ğ›Œ-calculus</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article</span>
                
                <span title="Words count in article">
                  8.9k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time</span>
                
                <span title="Reading time">
                  39
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="abstract">Abstract</h3>
<p><code>Type system</code>çš„åŸºæœ¬ç›®çš„æ˜¯é˜²æ­¢åœ¨ç¨‹åºè¿è¡Œæ—¶å‘ç”Ÿ<code>execution error</code>ã€‚è¿™ç§<code>Informal statement</code>éå½¢å¼åŒ–æè¿°æœ‰å¾ˆå¤šå†…æ¶µï¼šé¦–å…ˆè¯¥å¦‚ä½•ä¸¥æ ¼å®šä¹‰<code>execution error</code>ï¼›å…¶æ¬¡åœ¨è¿™ç§å®šä¹‰ä¸‹ï¼Œæè¿°<code>absence of execution error</code>ä¹Ÿæ˜¯<code>Type system</code>å¾ˆ<code>nontrivial</code>çš„æ€§è´¨â€”â€”å½“<code>PL .aka. programming language</code>çš„æ‰€æœ‰è¿è¡Œæ—¶è¡Œä¸ºéƒ½èƒ½ç¡®ä¿è¿™ç§æ€§è´¨çš„è¯ï¼Œæˆ‘ä»¬å°±è¯´è¯¥è¯­è¨€æ˜¯<code>type sound</code>çš„ã€‚äº‹å®è¯æ˜ä¸ºäº†æ›´åŠ æ²¡æœ‰æ­§ä¹‰çš„æè¿°<code>PL</code>çš„<code>type soundness</code>ï¼Œéœ€è¦åšå¤§é‡çš„åˆ†æå’Œè¯æ˜ã€‚å› æ­¤é’ˆå¯¹<code>Type system</code>çš„åˆ†ç±»ï¼Œæè¿°å’Œç ”ç©¶è¿‡ç¨‹é€æ¸æ¼”å˜æˆä¸ºä¸€å¥—<code>formal discipline</code>å³å½¢å¼åŒ–ä½“ç³»ã€‚ <span class="math display">\[
\frac{\Gamma_{1} \vdash \Im_{1}  ...  \Gamma_{n} \vdash \Im_{n}}{\Gamma \vdash \Im}
\]</span></p>
<p><code>The formalization of Type system</code>éœ€è¦ä¸€å¥—ç²¾ç¡®çš„ç¬¦å·å’Œå®šä¹‰ç³»ç»Ÿï¼Œä¸€ä¸ª<strong>ä¸¥æ ¼æ­£ç¡®</strong>çš„<code>Type system</code>å¯ä»¥å¯¹è¯­è¨€å®šä¹‰çš„å„ä¸ªé‡è¦æ€§è´¨è¿›è¡Œ<strong>å®Œæ•´</strong>çš„åˆ¤æ–­ã€‚è€Œéå½¢å¼åŒ–çš„æè¿°ç”šè‡³åšä¸åˆ°å®Œæ•´æ¦‚æ‹¬è¯­è¨€çš„<code>type structure</code>åˆ™æ›´è°ˆä¸ä¸Šå®ç°ä¸Šçš„å”¯ä¸€æ€§ã€‚æ¯”å¦‚ä¸åŒçš„ç¼–è¯‘å™¨å¯¹äºåŒä¸€å¥—è¯­è¨€<code>Type system</code>çš„å®ç°å¾€å¾€ä¸å°½ç›¸åŒï¼Œç”šè‡³æœ‰ä¸€äº›<code>type unsound</code>çš„è¯­è¨€å®šä¹‰å¯¼è‡´ä¸€æ®µä»£ç æ˜æ˜é€šè¿‡<code>typechecker</code>çš„æ£€æŸ¥ä½†åœ¨è¿è¡Œæ—¶å¥”æºƒæ‰ã€‚ç†æƒ³æƒ…å†µä¸‹æˆ‘ä»¬è¯´<code>formal Type system</code>åº”è¯¥æ˜¯æ‰€æœ‰<code>typed programming languages</code>å†…æ ¸å®šä¹‰çš„ä¸€éƒ¨åˆ†ã€‚è¿™æ ·çš„è¯ï¼Œ<code>typechecking</code>ç®—æ³•å°±å¯ä»¥ä¸¥æ ¼æŒ‰ç…§ç²¾ç¡®çš„ç±»å‹<code>spec</code>æ‰§è¡Œï¼Œä»æŸç§ç¨‹åº¦ä¸Šè¯¥è¯­è¨€å¯ä»¥çœ‹æˆæ˜¯<code>Type sound</code>çš„ã€‚</p>
<a id="more"></a>
<h3 id="introduction">Introduction</h3>
<h4 id="execution-errors">Execution errors</h4>
<p>æ¯”è¾ƒå…¸å‹çš„<code>execution error</code>å°±æ˜¯ç³»ç»Ÿå‡ºç°äº†æ„å¤–çš„<code>software faults</code>æ¯”å¦‚<code>illegal instruction fault</code>æˆ–è€…<code>illegal memory reference fault</code>ç­‰ã€‚ä½†æ˜¯ä¹Ÿå­˜åœ¨<code>execution error</code>ä¼šæ²¡æœ‰é¢„å…†çš„å‘ç”Ÿä»è€Œå¯¼è‡´æ•°æ®é”™è¯¯ã€‚è¿›ä¸€æ­¥çš„è¿˜å­˜åœ¨åƒ<code>divide by zero</code>ï¼Œæˆ–è€…<code>derferencing nil</code>ç­‰<strong><code>Type system</code>æ— æ³•é¿å…</strong>çš„<code>sofeware faults</code>ã€‚ä½†æ˜¯æœ‰çš„è¯­è¨€è™½ç„¶æ²¡æœ‰<code>Type system</code>å´ä¹Ÿä¸ä¼šå‘ç”Ÿ<code>software faults</code>ã€‚</p>
<h5 id="safety">safety</h5>
<p>é¦–å…ˆå¯¹<code>execution errors</code>è¿›è¡Œåˆ†ç±»ï¼š</p>
<ul>
<li><code>trapped errors:</code> å¯¼è‡´è®¡ç®—è¡Œä¸ºç¬é—´å¥”æºƒåœæ­¢
<ul>
<li>é™¤é›¶é”™è¯¯</li>
<li>å†…å­˜éæ³•è®¿é—®</li>
</ul></li>
<li><code>untrapped errors:</code>åˆšå¼€å§‹ä¸ä¼šå¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯åç»­ä¼šå¯¼è‡´ä»»æ„é”™è¯¯
<ul>
<li>æ²¡æœ‰è¿è¡Œæ—¶è¾¹ç•Œæ£€æŸ¥çš„æ•°ç»„è¶Šç•Œ</li>
<li>å¼•ç”¨é”™è¯¯åœ°å€</li>
</ul></li>
</ul>
<blockquote>
<p>A program fragment is <strong>safe</strong> if it does not cause <strong>untrapped errors</strong> to occur.</p>
</blockquote>
<p>æ‰€æœ‰ç¨‹åºéƒ½æ˜¯<code>safe</code>çš„è¯­è¨€ç§°ä¸º<code>safe languages</code>â€”â€”å› æ­¤<code>safe languages</code>æ˜¯è¦èƒ½æ’é™¤ä¸€åˆ‡æ½œåœ¨é”™è¯¯ã€‚<code>untyped languages</code>é€šè¿‡<code>runtime checks</code>æ¥è¾¾åˆ°<code>safety</code>â€”â€”<code>typed languages</code>é€šè¿‡<code>static</code>é™æ€(æ¯”å¦‚ç¼–è¯‘æœŸ)æ’é™¤ä¸€åˆ‡æ½œåœ¨é”™è¯¯è¡Œä¸ºæ¥è¾¾åˆ°<code>safety</code>ï¼Œå…¶ä¹Ÿå¯ä»¥åŒæ—¶é‡‡ç”¨<code>runtime</code>å’Œ<code>static</code>æ£€æŸ¥ã€‚</p>
<h5 id="well-behaved">well-behaved</h5>
<p>é’ˆå¯¹é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Œæˆ‘ä»¬åº”è¯¥æç‚¼å‡º<code>execution errors</code>çš„ä¸€ä¸ªå­é›†ä½œä¸º<code>forbidden errors</code>ã€‚è¿™ä¸ªå­é›†åº”è¯¥åŒ…å«æ‰€æœ‰çš„<code>untrapped errors</code>ï¼Œä»¥åŠä¸€éƒ¨åˆ†<code>trapped errors</code>ã€‚</p>
<blockquote>
<p>A program fragment is said to have <strong>good behavior/well-behaved</strong>, if it doesn't cause any <strong>forbidden error</strong> to occur.</p>
</blockquote>
<p><strong>å¯¹æ¯”ä¸€ä¸‹<code>safe</code>å’Œ<code>well-behaved</code>çš„å®šä¹‰å°±å¯ä»¥å‘ç°<code>well-behaved</code>çš„ä»£ç æ˜¯<code>safe</code>çš„ï¼Œä½†åä¹‹ä¸ç„¶ã€‚</strong>æ‰€æœ‰ä»£ç éƒ½æ˜¯<code>well-behaved</code>çš„è¯­è¨€è¢«ç§°ä¸º<code>strongly checked</code>ã€‚é’ˆå¯¹ä¸€ä¸ª<code>Strongly checked</code>çš„è¯­è¨€çš„ç‰¹å¾ï¼š</p>
<ul>
<li>ä¸ä¼šå‡ºç°<code>untrapped errors</code>ï¼ˆ<code>safe</code>çš„ä¿è¯ï¼‰</li>
<li>ä¸ä¼šå‡ºç°åŒ…å«åœ¨<code>forbidden errors</code>ä¸­çš„éƒ¨åˆ†<code>trapped errors</code></li>
<li>å…¶ä½™çš„<code>trapped errors</code>å‘ç”Ÿä¹Ÿåªä¼šç”±äºç¨‹åºå‘˜çš„è‡ªèº«é—®é¢˜å¯¼è‡´</li>
</ul>
<p><code>Typed languages</code>é€šè¿‡è¿è¡Œé™æ€æ£€æŸ¥(æ¯”å¦‚ç¼–è¯‘æœŸ)æ¥å®ç°è¯­è¨€çš„<code>well-behaved</code>â€”â€”è¿™æ ·çš„è¯­è¨€è¢«ç§°ä¸ºæ˜¯<code>staticlly checked</code>ï¼Œæ•´ä¸ªæ£€æŸ¥è¿‡ç¨‹è¢«ç§°ä¸º<code>typechecking</code>ï¼Œæ‰§è¡Œè¯¥æ£€æŸ¥è¿‡ç¨‹çš„ç®—æ³•è¢«ç§°ä¸º<code>type-checker</code>ã€‚ä¸€æ®µç»è¿‡<code>type-checker</code>æ£€æŸ¥çš„ç¨‹åºè¢«ç§°ä¸º<code>well-typed</code>ã€‚<code>staticlly checked languages</code>æœ‰<code>ML,Java,Pascal</code>ç­‰ã€‚</p>
<p><code>Untyped languages</code>é€šè¿‡è¿è¡Œæ—¶æ£€æŸ¥<code>runtime checks</code>æ¥æ’é™¤æ‰€æœ‰çš„<code>forbidden errors</code>ã€‚æ¯”å¦‚å®ƒä»¬ä¼šæ£€æŸ¥æ‰€æœ‰æ•°ç»„è¾¹ç•Œï¼Œæ‰€æœ‰é™¤æ³•æ“ä½œï¼Œå¹¶åœ¨é”™è¯¯å‡ºç°çš„æ—¶å€™è§¦å‘å¼‚å¸¸ã€‚æ•´ä¸ªæ£€æŸ¥è¿‡ç¨‹è¢«ç§°ä¸º<code>dynamic checking</code>ã€‚<code>LISP</code>å°±æ˜¯è¿™æ ·ä¸€é—¨è¯­è¨€ï¼Œè¿™æ ·çš„è¯­è¨€å°½ç®¡æ²¡æœ‰é™æ€æ£€æŸ¥ï¼Œæ²¡æœ‰ç±»å‹ç³»ç»Ÿï¼Œä½†å´è¿˜æ˜¯<code>strongly checked</code>ã€‚</p>
<h5 id="safety-or-performance">safety or Performance</h5>
<p><code>type system</code>çš„é¦–è¦ç›®æ ‡å°±æ˜¯è¦é€šè¿‡æ’é™¤æ‰€æœ‰ç¨‹åºè¿è¡Œæ—¶çš„<code>untrapped errors</code>æ¥ç¡®ä¿ç¨‹åºçš„<code>safety</code>ã€‚ä½†æ˜¯å®é™…ä¸Šå¾ˆå¤šé™æ€è¯­è¨€éƒ½ä¸èƒ½ä¿è¯<code>safety</code>â€”â€”å®ƒä»¬çš„ç±»å‹ç³»ç»Ÿå¹¶æ²¡æœ‰å®Œå…¨æ’é™¤æ‰è¿è¡Œæ—¶çš„<code>untrapped errors</code>ã€‚è¿™äº›è¯­è¨€è¢«ç§°ä¸ºæ˜¯<code>weakly-typed</code>ï¼Œè€Œä¸”å…¶ç¨‹åº¦éƒ½å„è‡ªä¸åŒã€‚<code>C</code>åœ¨<code>pointer arithmetic</code>å’Œ<code>casting</code>ä¸Šæœ‰å¤§é‡<code>unsafe</code>çš„æ“ä½œã€‚</p>
<p>å¤§å¤šæ•°<code>untyped languages</code>éƒ½æ˜¯<code>completely safe</code>çš„ï¼Œå¦åˆ™ç¨‹åºæ—¢æ²¡æœ‰ç¼–è¯‘æœŸæ£€æŸ¥åˆæ²¡æœ‰è¿è¡Œæ—¶æ£€æŸ¥ä¸€æ—¦å‡ºé”™åæœä¸å ªè®¾æƒ³ã€‚æ¯”å¦‚<code>Assembly</code>å°±å±äºè¿™ç§è¯­è¨€èŒƒç•´ã€‚</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Typed</th>
<th>Untyped</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Safe</td>
<td>MLã€Java</td>
<td>LISP</td>
</tr>
<tr class="even">
<td>Unsafe</td>
<td>C</td>
<td>Assembly</td>
</tr>
</tbody>
</table>
<p>ä½†ç¨‹åºè¯­è¨€çš„<code>safety</code>å±æ€§ä¸€èˆ¬éœ€è¦ä»¥ç‰ºç‰²æ€§èƒ½ä¸ºä»£ä»·ã€‚ä½†æ˜¯ç©¶å…¶ä¼˜åŠ¿ï¼šå¯ä»¥é€šè¿‡å¼•å…¥<code>garbage collection</code>æ¥ç¡®ä¿è¿è¡Œæ—¶ç»“æ„çš„å®Œæ•´ï¼Œæœ€åå…¶å¯¹äºåƒ<code>OS/web browsers</code>ç­‰åº”ç”¨çš„å®‰å…¨æä¾›äº†ä¿è¯ã€‚</p>
<p>é‚£å®ç°<code>safety</code>æ˜¯é€šè¿‡ç±»å‹ç³»ç»Ÿå³é™æ€è¿˜æ˜¯è¿è¡Œæ—¶å³åŠ¨æ€:</p>
<ul>
<li><code>untyped languages</code>ä¼šå¯¼è‡´å¤§é‡<code>safety</code>é—®é¢˜</li>
<li><code>untyped languages</code>æ¯”å¦‚<code>LISP</code>è¦æ¯”<code>weakly-typed languages</code>æ¯”å¦‚<code>C</code>æ›´éš¾ç»´æŠ¤</li>
</ul>
<h4 id="typed-and-untyped-languages">Typed and untyped languages</h4>
<p>ç¨‹åºå˜é‡åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å¯ä»¥å‡å®šä¸€ç³»åˆ—çš„å€¼ã€‚</p>
<blockquote>
<p><font color="red">An upper bound of such a range is called a <strong>type</strong> of the variable.</font></p>
</blockquote>
<p>è¯¥å˜é‡çš„ä¸€ä¸ªç±»å‹å°±æ˜¯å…¶å€¼çš„ä¸€ä¸ª<code>upper bound</code>ã€‚æ¯”å¦‚ä¸€ä¸ª<code>Boolean</code>ç±»å‹çš„å˜é‡åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åªèƒ½æ˜¯<code>true/false</code>ï¼Œè€Œ<code>not(x)</code>åœ¨è¿è¡Œæ—¶ä¹Ÿæ˜¯æœ‰æ„ä¹‰çš„ã€‚ä¸€é—¨æ‰€æœ‰å˜é‡éƒ½æœ‰<code>nontrivial types</code>çš„è¯­è¨€ç§°ä¸º<code>typed languages</code>ã€‚è€Œæ²¡æœ‰é™åˆ¶å˜é‡èŒƒå›´çš„è¯­è¨€ç§°ä¸º<code>untyped languages</code>â€”â€”å…¶å˜é‡æ²¡æœ‰<code>type</code>ï¼Œæˆ–è€…è¯´å…¶å˜é‡éƒ½æœ‰ä¸€ä¸ª<code>universal type</code>ã€‚</p>
<p><code>Type system</code>æ˜¯<code>type languages</code>çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œç”¨æ¥è·Ÿè¸ª<code>types of variables</code>ï¼Œæ›´æ™®éçš„ç”¨æ¥è·Ÿè¸ª<code>types of expression</code>ã€‚åªæœ‰éµå®ˆ<code>type system</code>çš„ä»£ç æ‰å¯ä»¥æˆä¸ºè¯¥<code>type language</code>çš„åˆæ ¼ç¨‹åºã€‚è€Œ<code>type system</code>å¯èƒ½ä¸ä¼šåœ¨è¯­è¨€çš„è¯­æ³•ä¸­æ˜¾å¼å‡ºç°ã€‚</p>
<blockquote>
<p><font color="red">Type systems are used to determine whether programs are <strong>well behaved.</strong></font></p>
</blockquote>
<ul>
<li><code>Explicitly typed:</code> <code>types</code>æ˜¯è¯­æ³•çš„ä¸€éƒ¨åˆ†</li>
<li><code>implicitly typed:</code> <code>types</code>ä¸ä¼šæ˜¾å¼å‡ºç°åœ¨è¯­æ³•ä¸­</li>
</ul>
<h5 id="properties-of-type-systems">properties of type systems</h5>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œå‡è®¾ç¨‹åºè¯­è¨€éœ€è¦å³<code>safe</code>åˆ<code>type</code>ï¼Œå› æ­¤å¼•å…¥<code>type system</code>çš„è®¨è®ºã€‚</p>
<p><code>Types</code>ï¼Œä½œä¸ºç¨‹åºè¯­è¨€çš„ä¸€éƒ¨åˆ†æœ‰ç€å’Œå…¶ä»–<code>program annotations</code>ç¼–ç¨‹æ ‡è®°æ›´åŠ å®ç”¨çš„ç‰¹å¾ã€‚æ€»ä½“ä¸Šæ¥è¯´ï¼Œå¯¹äºç¨‹åºè¯­è¨€è¡Œä¸ºçš„<code>annotations</code>æ¶µç›–äº†<code>informal comments</code>ï¼Œ<code>formal spec</code>ï¼Œç”šè‡³<code>theorem proving</code>ç­‰ã€‚è€Œ<code>Types</code>å°±åœ¨å‡ ä¸ªèŒƒç•´çš„ä¸­å¿ƒåœ°å¸¦â€”â€”å…¶æ¯”<code>comments</code>æ›´åŠ ç²¾ç¡®ï¼Œä½†æ˜¯æ¯”<code>formal spec</code>æ›´åŠ ç®€æ´å’Œæ˜“ç”¨ã€‚æ€»ä½“æ¥è®²<code>type system</code>æœ‰å¦‚ä¸‹å±æ€§ï¼š</p>
<ul>
<li><code>decidably verifiable:</code> éœ€è¦æœ‰ç®—æ³•(æŒ‡çš„æ˜¯<code>typechecker</code>)æ¥ç¡®ä¿ç¨‹åºæ˜¯<code>well-behaved</code>çš„ã€‚<code>type system</code>çš„ç›®çš„ä¸ä»…ä»…æ˜¯æè¿°å¼€å‘è€…çš„æ„å›¾ï¼Œæ›´é‡è¦çš„æ˜¯ä¸ºäº†æ•æ‰ç¨‹åºè¿è¡Œæ—¶é”™è¯¯ã€‚ï¼ˆ<code>formal spec</code>åªèƒ½è¿›è¡Œæè¿°ï¼‰</li>
<li><code>transparent:</code> å¼€å‘è€…å¯¹äº<code>typechecker</code>çš„è¡Œä¸ºåº”è¯¥å¾ˆæ˜“äºä¸Šæ‰‹ã€‚æ¯”å¦‚å¾ˆå®¹æ˜“çœ‹å‡ºæŸæ®µä»£ç æ˜¯å¦å¯ä»¥é€šè¿‡ç±»å‹æµ‹è¯•ï¼Œå¦‚æœæ²¡æœ‰é€šè¿‡åˆ™é—®é¢˜ä¸€å®šæ˜¯å¼€å‘è€…è‡ªèº«ï¼ˆ<code>automatic theorem proving</code>ç›¸æ¯”ä¹‹ä¸‹æ›´æ™¦æ¶©éš¾æ‡‚ï¼‰</li>
<li><code>enforceable:</code> <code>type declarations</code>åº”è¯¥è¢«å°½å¯èƒ½çš„å®Œæˆé™æ€/åŠ¨æ€æ£€æŸ¥ã€‚ç±»å‹å£°æ˜å’Œå…¶å¯¹åº”ç¨‹åºä¹‹é—´çš„ä¸€è‡´æ€§åº”è¯¥ç¬¦åˆéªŒè¯ã€‚ï¼ˆ<code>comments</code>æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼‰</li>
</ul>
<h4 id="how-type-systems-are-formalized">How type systems are formalized</h4>
<p>æˆ‘ä»¬å¦‚ä½•ä¿è¯<code>well-typed</code>çš„ç¨‹åºç¡®å®æ˜¯<code>well-behaved</code>çš„å‘¢ï¼Ÿ</p>
<blockquote>
<p>è¿™é‡Œçš„<code>well-typed</code>æŒ‡çš„æ˜¯é€šè¿‡äººä¸ºè®¾è®¡çš„ç±»å‹ç³»ç»Ÿç®—æ³•<code>typechecker</code>ï¼Œè€Œ<code>well-behaved</code>æŒ‡çš„æ˜¯åœ¨è¿è¡Œæ—¶ä¸ä¼šå‡ºç°<code>forbidden errors</code>ã€‚</p>
</blockquote>
<p><code>Formal type systems</code>å°±æ˜¯åœ¨PLæ–‡æ¡£ä¸­å¯¹<code>type system</code>éå½¢å¼åŒ–æè¿°èƒŒåçš„æ•°å­¦ç‰¹å¾æè¿°ã€‚ä¸€æ—¦æŸä¸€ä¸ª<code>type system</code>è¢«å½¢å¼åŒ–äº†ï¼Œæˆ‘ä»¬åªéœ€è¯æ˜ä»¥ä¸‹<code>soundness theorem</code>ï¼š</p>
<blockquote>
<p><em>Well-typed</em> programs are <em>well-behaved</em>.</p>
</blockquote>
<p>ä¸€æ—¦è¯¥å®šç†æˆç«‹ï¼Œæˆ‘ä»¬å°±è¯´è¯¥<code>type system</code>æ˜¯<code>sound</code>çš„ã€‚</p>
<blockquote>
<p>Good behavior of all programs of a typed language and soundness of its type system mean the same thing.</p>
</blockquote>
<h5 id="type-and-term">type and term</h5>
<p>ä¸ºäº†å½¢å¼åŒ–ä¸€é—¨ç¨‹åºè¯­è¨€çš„<code>type system</code>å¹¶ä¸”è¯æ˜<code>soundness theorem</code>ï¼Œå°±éœ€è¦åœ¨æœ¬è´¨ä¸Šå°†æ•´ä¸ªè¯­è¨€éƒ½å½¢å¼åŒ–ã€‚é¦–å…ˆè¦åšçš„å°±æ˜¯æè¿°è¯¥è¯­è¨€çš„è¯­æ³•<code>syntax</code>ã€‚å¯¹äºå¤§å¤šæ•°è¯­è¨€æ¥è¯´è¿™å°±æ„å‘³ç€æè¿°å…¶<code>types and terms</code>çš„è¯­æ³•ã€‚</p>
<ul>
<li><code>Types</code>æè¿°ç¨‹åºçš„é™æ€è¡Œä¸º</li>
<li><code>Terms(statements, expressions, and other program fragments)</code>æè¿°ç®—æ³•çš„è¡Œä¸º</li>
</ul>
<h5 id="scoping-rules">scoping rules</h5>
<p>ä¸‹ä¸€æ­¥æ˜¯å®šä¹‰è¯­è¨€çš„<code>scoping</code>è§„åˆ™â€”â€”è¯¥è§„åˆ™æ˜ç¡®å®šä¹‰äº†<font color="red">æ ‡è¯†ç¬¦çš„ä½œç”¨åŸŸå³æ ‡è¯†ç¬¦<code>binding locations</code>å£°æ˜å¤„å’Œ<code>occurrences</code>ä½¿ç”¨å¤„çš„è”ç³»ã€‚<code>Typed languages</code>éœ€è¦è¿™ç§<code>scoping</code>æ˜¯é™æ€çš„ï¼Œæ¢å¥è¯è®²å°±æ˜¯è¯´æ ‡è¯†ç¬¦çš„å£°æ˜<code>binding locations</code>ä¸€å®šè¦åœ¨è¿è¡Œæ—¶ä¹‹å‰ã€‚</font>è€Œæ ‡è¯†ç¬¦çš„å£°æ˜å¤„<code>binding locations</code>å¾€å¾€æ˜¯ç”±è¯­è¨€è¯­æ³•å†³å®šçš„ï¼Œå› æ­¤<code>static scoping</code>ä¹Ÿå«åš<code>lexical scoping</code>ã€‚ä¸ä¹‹ç›¸åçš„å°±æ˜¯<code>dynamic scoping</code>ã€‚</p>
<blockquote>
<p>Scoping can be formally specified by defining the set of<font color="red"> free variables</font> of a program fragment (which involves specifying how variables are bound by declarations). The associated notion of substitution of types or terms for free variables can then be defined.</p>
</blockquote>
<p>å¯¹äºä½œç”¨åŸŸçš„å½¢å¼åŒ–å¯ä»¥å®šä¹‰ä¸€ä¸ª<code>program fragment</code>çš„ä¸€ç³»åˆ—<code>free variable</code>,æ¥ç€å¯ä»¥å®šä¹‰å¦‚ä½•ä½¿ç”¨<code>types/terms</code>æ¥æ›¿æ¢è¿™äº›å˜é‡ã€‚</p>
<ul>
<li><font color="blue">scoping rules, binding locations, free variable</font></li>
</ul>
<h5 id="type-rules">type rules</h5>
<p>å½“è¿™äº›æå®šåï¼Œå¼€å§‹å®šä¹‰ç¨‹åºè¯­è¨€çš„<code>type rules</code>ï¼šå…¶é€šè¿‡<code>M:A</code>çš„å½¢å¼å®šä¹‰äº†<code>terms M</code>å’Œ<code>types A</code>ä¹‹é—´çš„ä¸€ç§<code>has-type</code>å…³ç³»ã€‚æœ‰äº›è¯­è¨€è¿˜é€šè¿‡<code>A&lt;:B</code>çš„å½¢å¼å®šä¹‰<code>types</code>ä¹‹é—´çš„<code>subtype-of</code>å…³ç³»ï¼Œè¿˜æœ‰é€šè¿‡<code>A=B</code>çš„å½¢å¼å®šä¹‰<code>types</code>ä¹‹é—´çš„<code>equal-type</code>å…³ç³»ã€‚</p>
<blockquote>
<p>The collection of type rules of a language forms its type system.</p>
</blockquote>
<h5 id="static-typing-environments">static typing environments</h5>
<p>åœ¨å½¢å¼åŒ–<code>type rules</code>ä¹‹å‰è¿˜éœ€è¦å¼•å…¥å¦ä¸€ä¸ªä¸ä¼šæ˜¾å¼å‡ºç°åœ¨è¯­æ³•ä¸­çš„åŸºæœ¬æ¦‚å¿µâ€”â€”<font color="red"><code>static typing environments</code>ï¼šå…¶åœ¨å¤„ç†<code>program fragments</code>çš„è¿‡ç¨‹ä¸­è®°å½•<code>free variable</code>çš„<code>type</code>ã€‚</font>ä¸€èˆ¬å’Œç¼–è¯‘å™¨åœ¨å¤„ç†<code>typechecking</code>è¶Ÿæ—¶å…¶ç¬¦å·è¡¨çš„å†…å®¹ç›¸å¯¹åº”ã€‚</p>
<blockquote>
<p><font color="red">The type rules are always formulated with respect to a static environment for the fragment being typechecked.</font></p>
</blockquote>
<p><font color="blue">æ¯”å¦‚ä¸€ä¸ª<code>has-type</code>å…³ç³»<code>M:A</code>ï¼Œä½†æ˜¯è¿™ä¸ªå…³ç³»ä¸‹<code>type A</code>å’Œ<code>term M</code>ç›¸å…³çš„<code>freeÂ variable</code>çš„ä¿¡æ¯åœ¨<code>static environment ğšª</code>é‡Œé¢çš„</font>ã€‚æ•…è¿™ä¸ªå…³ç³»å…¨ç§°åº”è¯¥æ˜¯<code>ğšª âŠ¢ M:A</code>ï¼Œæ„æ€æ˜¯<strong>åœ¨é™æ€ç¯å¢ƒğšªä¸‹ï¼ŒMæœ‰Aç±»å‹</strong>ã€‚</p>
<h5 id="semantics">semantics</h5>
<p>å½¢å¼åŒ–ç¨‹åºè¯­è¨€çš„æœ€åä¸€æ­¥å°±æ˜¯å°†å…¶è¯­ä¹‰å®šä¹‰ä¸ºä¸€ç§<code>terms</code>å’Œ<code>results</code>ä¹‹é—´çš„<code>relation</code>ã€‚è¯¥<code>relation</code>çš„å½¢å¼å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæ‰€é‡‡ç”¨çš„è¯­ä¹‰å­¦é£æ ¼ã€‚è¯­è¨€çš„è¯­ä¹‰å’Œ<code>type system</code>æ˜¯ç›¸äº’å½±å“çš„â€”â€”<code>term</code>çš„<code>type</code>å’Œå…¶<code>results</code>åº”è¯¥ä¸€æ ·æˆ–æ­£ç›¸å…³ï¼Œè¿™æ˜¯<code>soundness theorem</code>çš„æœ¬è´¨ã€‚</p>
<blockquote>
<p><font color="red">the types of a term and of itsresult should be the same (or appropriately related); this is the essence of the soundness theorem.</font></p>
</blockquote>
<p><code>type system</code>çš„åŸºæœ¬æ¦‚å¿µå¯¹å‡ ä¹æ‰€æœ‰ç¼–ç¨‹èŒƒå¼ï¼ˆå‡½æ•°å¼ï¼Œå‘½ä»¤å¼ï¼Œå¹¶è¡Œï¼‰éƒ½æ˜¯é€‚ç”¨çš„ã€‚ç‹¬ç«‹çš„<code>type rules</code>åº”ç”¨äºä¸åŒçš„èŒƒå¼æ—¶åŸºæœ¬ä¸èƒ½æ”¹å˜ã€‚æ¯”å¦‚<code>call-by-name</code>å’Œ<code>call-by-value</code>çš„å‡½æ•°çš„åŸºæœ¬è¯­ä¹‰æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>è¿™ç« èŠ‚æˆ‘ä»¬è®¨è®ºäº†ç‹¬ç«‹äºè¯­ä¹‰çš„<code>type system</code>ã€‚ä½†æ˜¯éœ€è¦è‚¯å®šçš„æ˜¯ï¼Œ<code>type system</code>ä¸€å®šå’Œä¸€é—¨è¯­ä¹‰ä»¥åŠè¯¥è¯­ä¹‰æ‰€å¸¦çš„<code>soundness</code>ç›¸å…³ã€‚</p>
<blockquote>
<p>The techniques of structrual operational semantics deal uniformly with a large collection of programming paradigms.</p>
</blockquote>
<h4 id="type-equivalence">Type equivalence</h4>
<p>æ­£å‘å‰æ–‡æ‰€è¯´çš„ï¼Œå¤§å¤šæ•°<code>nontrivial type system</code>éƒ½ä¼šå®šä¹‰ä¸€ç§<code>equal type</code>çš„å…³ç³»ä»£è¡¨<code>type equivalence</code>ã€‚è¿™ä¸€å±æ€§åœ¨å®šä¹‰ä¸€é—¨ç¼–ç¨‹è¯­è¨€æ—¶å€™å¼‚å¸¸é‡è¦ï¼š<strong>ä»€ä¹ˆæ—¶å€™ä¸¤ä¸ªåˆ†åˆ«å®šä¹‰çš„<code>type expression</code>æ˜¯ä¸€è‡´çš„ï¼Ÿ</strong>æ¯”å¦‚ä¸¤ä¸ªç”±ç›¸ä¼¼ç±»å‹è¿æ¥çš„ä¸åŒ<code>type names</code>ï¼š</p>
<blockquote>
<p>type X = Bool.</p>
<p>type Y = Bool.</p>
</blockquote>
<p>å¦‚æœ<code>type names</code>Xå’ŒYå› ä¸ºä¸ç›¸ä¼¼ç±»å‹å…³è”è€ŒåŒ¹é…ï¼Œæˆ‘ä»¬ç§°ä¸º<code>structural equivalence</code>ã€‚å¦‚æœç”±äº<code>type names</code>ä¸åŒè€Œæ— æ³•åŒ¹é…ï¼ˆå¹¶æ²¡æœ‰å‚è€ƒç›¸å…³è”çš„ç±»å‹ï¼‰ï¼Œæˆ‘ä»¬ç§°ä¸º<code>by-name equivalence</code>ã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹å¤§å¤šæ•°è¯­è¨€ä¼šä½¿ç”¨<code>structural and by-name</code>çš„æ··åˆã€‚<code>Pure structural equivalence</code>å¯ä»¥é€šè¿‡<code>type rules</code>ç²¾ç¡®å®šä¹‰ï¼Œç„¶è€Œ<code>by-name equivalence</code>æ›´éš¾ç¡®å®šã€‚åç»­çš„è®¨è®ºæˆ‘ä»¬åŸºæœ¬è®¨è®º<code>structural equivalence</code>ï¼Œè€Œ<code>by-name equivalence</code>å¯ä»¥ä½¿ç”¨å‰è€…å¾ˆå¥½çš„è¿›è¡Œæ¨¡æ‹Ÿã€‚</p>
<h3 id="the-language-of-type-systems">The language of type systems</h3>
<p><code>Type system</code>å®šä¹‰ç¨‹åºè¯­è¨€çš„<code>type rules</code>â€”â€”ç‹¬ç«‹äºç‰¹å®šçš„<code>typechecking algorithms</code>ã€‚å…¶å’Œ<code>formal grammar</code>å®šä¹‰ç¨‹åºè¯­è¨€çš„<code>syntax</code>ä½†ç‹¬ç«‹äºç‰¹å®šçš„<code>parsing algorithms</code>æ˜¯åŒæ ·çš„é“ç†ã€‚</p>
<p>å°†<code>type system</code>å’Œ<code>typechecking algorithms</code>åˆ†ç¦»æ›´åŠ é«˜æ•ˆï¼š<code>type system</code>å±äºè¯­è¨€å®šä¹‰<code>language definitions</code>ï¼Œè€Œ<code>algorithms</code>å±äºç¼–è¯‘å™¨å®ç°ã€‚é€šè¿‡<code>type system</code>æ˜ å°„è¯­è¨€çš„ç±»å‹ä¿¡æ¯è¦æ¯”ç”¨ç¼–è¯‘å™¨ç®—æ³•æ›´åŠ ç®€æ´ã€‚åŒä¸€å¥—<code>type system</code>åœ¨ä¸åŒç¼–è¯‘å™¨ä¸Šå¯èƒ½ä¼šæœ‰å¤šç§<code>typechecking</code>ç®—æ³•ã€‚</p>
<h4 id="judgements">Judgements</h4>
<p><code>Type system</code>ç”±ä¸€å¥—ç‰¹æ®Šçš„å½¢å¼åŒ–æ–¹æ³•æè¿°ã€‚ä¸‹é¢å¼€å§‹è®¨è®ºï¼š</p>
<p>é¦–å…ˆå¼•å…¥ä¸€å¥—å½¢å¼åŒ–æœºåˆ¶ç§°ä½œ<code>judgments</code>: <span class="math display">\[
\Gamma \vdash \Im  \qquad \text{â„‘ is an assertion;the free variables of â„‘ are declared in ğšª}
\]</span> è¯»ä½œ<code>ğšª entails â„‘</code>(ğšªåŒ…å«â„‘)ã€‚</p>
<p><code>ğšª</code>æ˜¯ä¸€ä¸ª<code>static typing environment</code>ï¼Œæ¯”å¦‚ä¸€ä¸ªç”±ä¸åŒå˜é‡åŠå…¶ç›¸åº”<code>type</code>ç»„æˆçš„æœ‰åºé“¾è¡¨ï¼Œé€šè¿‡âˆ…, x<sub>1</sub>:A<sub>1</sub>, ..., x<sub>n</sub>:A<sub>n</sub>çš„å½¢å¼ã€‚ç©ºç¯å¢ƒè®°ä½œâˆ…ï¼Œè€Œåœ¨ğšªç¯å¢ƒä¸­å£°æ˜çš„å˜é‡é›†åˆx<sub>1</sub>...x<sub>n</sub>è®°ä½œ<code>dom(ğšª)</code>â€”â€”ğšªçš„<code>domain</code>å€¼åŸŸã€‚</p>
<p><font color="red">â„‘æ˜¯ä¸€ç§æ–­è¨€ï¼Œå…¶å½¢å¼éšç€ä¸åŒçš„<code>judgement</code>ä¼šå˜åŒ–ï¼Œä½†æ˜¯â„‘ä¸­çš„æ‰€æœ‰<code>free variables</code>éƒ½å¿…é¡»<strong>å£°æ˜</strong>åœ¨ğšªä¸­ã€‚</font></p>
<blockquote>
<p><font color="blue"> a term M has a type A with respect to a static typing environment for the free variables of M. Â  æœ€é‡è¦çš„<code>judgement</code>æ˜¯<code>typing judgement</code>ï¼Œå…¶æ–­è¨€ä¸ºï¼šå¯¹äºé’ˆå¯¹<code>M</code>ä¸­æ‰€æœ‰<code>freeÂ variable</code>çš„é™æ€ç¯å¢ƒ<code>ğšª</code>çš„æ¥è¯´ï¼Œ<code>term M</code>çš„ç±»å‹æ˜¯<code>A</code>ã€‚</font></p>
</blockquote>
<ul>
<li>Term: statements, expressions, and other program fragments</li>
</ul>
<p><span class="math display">\[
\Gamma \vdash M:A   \qquad \text{M has type A in ğšª}
\]</span></p>
<p>æ¯”å¦‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š <span class="math display">\[
\begin{aligned}
&amp;\emptyset \vdash true:Bool &amp;&amp;\qquad \text{true has type Bool} \\
&amp;\emptyset,x:Nat \vdash x+1:Nat &amp;&amp;\qquad \text{x+1 has type Nat, provided that x has type Nat}\\
\end{aligned}
\]</span> å…¶ä»–ç±»å‹çš„<code>judgement</code>ä¹Ÿå¾ˆå¸¸è§ï¼Œæ¯”å¦‚ä¸‹é¢æ–­è¨€ä¸º<code>an environment is well-formed</code>: <span class="math display">\[
\Gamma \vdash \diamond  \qquad \text{ğšª is well-formed(i.e., it has been properly constructed)}
\]</span></p>
<h4 id="type-rules-1">Type rules</h4>
<p><code>Type rules</code>ï¼šåœ¨<code>valid judgements</code>çš„å‰æä¸‹ï¼Œæ–­è¨€<code>certain judgement</code>æœ‰æ•ˆã€‚ä¸€èˆ¬éƒ½ä»¥æŸäº›æœ¬è´¨ä¸Šæœ‰æ•ˆçš„<code>judgements</code>ä½œä¸ºå¼€å§‹(å¸¸è§çš„æœ‰ï¼šâˆ…âŠ¢â—‡,è¡¨ç¤º<code>empty environment is well-formed</code>)ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{ (Rule name)} \quad \quad \text{ (Annotations)}    \\
&amp;\frac{\Gamma_{1} \vdash \Im_{1}  \quad ... \quad \Gamma_{n} \vdash \Im_{n} \text{ (Annotations)}}{\Gamma \vdash \Im}
\end{aligned}
\qquad \text{ General form of a type rule.}
\]</span> æ¯ä¸€ä¸ª<code>type rule</code>çš„æ ¼å¼ï¼šåœ¨æ°´å¹³çº¿ä¸Šé¢çš„æ˜¯ä¸€ç³»åˆ—<code>premise judgements</code>:ğšª<sub>i</sub> âŠ¢ â„‘<sub>i</sub>ï¼Œè€Œåœ¨æ°´å¹³çº¿ä¸‹é¢çš„æ˜¯<code>conclusion judgements</code>: ğšªâŠ¢â„‘ã€‚å½“æ‰€æœ‰çš„<code>premise</code>éƒ½æ»¡è¶³ä¹‹åï¼Œ<code>conclusion</code>ä¸€å®šæˆç«‹ã€‚<code>premise</code>çš„æ•°é‡å¯ä»¥ä¸ºé›¶ã€‚è€Œä¸”æ¯ä¸€ä¸ª<code>type rules</code>éƒ½æœ‰ä¸€ä¸ªåå­—ï¼šæ ¹æ®æƒ¯ä¾‹ï¼Œåå­—çš„ç¬¬ä¸€ä¸ªå•è¯æ˜¯ç”±<code>conclusion judgements</code>è§„å®šçš„~æ¯”å¦‚<code>conclusion</code>æ˜¯ä¸€ä¸ª<code>value typing judgement</code>çš„<code>type rules</code>çš„åå­—å°±ä¼šå«åš<code>Val...</code>ã€‚å¿…è¦çš„æ—¶å€™ï¼Œé™åˆ¶<code>rule</code>çš„ä¸€äº›æ¡ä»¶å’Œéœ€è¦ç”¨åˆ°çš„ä¸€äº›ç¼©å†™éƒ½ä¼šåœ¨<code>typ rule</code>æˆ–è€…<code>premise</code>æ—è¾¹è¿›è¡Œæ‰¹æ³¨ã€‚æ¯”å¦‚ä¸€ä¸‹ä¾‹å­ï¼š <span class="math display">\[
\begin{aligned}
&amp;\text{ (Val n) (n=0,1,...)} \\
&amp;\frac{ \Gamma \vdash \diamond }{\Gamma \vdash n:Nat}
\end{aligned} \qquad 
\begin{aligned}
&amp;\text{ (Val+)} \\
&amp;\frac{\Gamma \vdash M:Nat \qquad \Gamma \vdash N:Nat}{\Gamma \vdash \text{M+N:Nat}} 
\end{aligned}
\]</span> æ¯”å¦‚ç¬¬ä¸€ä¸ª<code>type rule</code>è¡¨ç¤ºæ‰€æœ‰çš„<code>numeral</code>è‡ªç„¶æ•°éƒ½æ˜¯<code>Nat</code>ç±»å‹ã€‚<font color="red">ç¬¬äºŒä¸ªã€ç»“åˆ<code>TypingÂ Judgements</code>ã€‘</font><code>type rule</code>è¡¨ç¤ºä¸¤ä¸ª<code>Nat</code>ç±»å‹çš„è¡¨è¾¾å¼<code>M</code>å’Œ<code>N</code>å¯ä»¥æ„æˆä¸€ä¸ªæ›´å¤§çš„<code>Nat</code>ç±»å‹çš„è¡¨è¾¾å¼<code>M+N</code>ï¼Œ<font color="blue">Moreover, the environment ğšª for M and N, which declares the types of any free variable of M and N, carries over to M+Nå¹¶ä¸”é™æ€ç¯å¢ƒ<code>ğšª</code>ä¸ä»…å£°æ˜äº†<code>M</code>å’Œ<code>N</code>çš„æ‰€æœ‰<code>freeÂ variable</code>çš„ç±»å‹ï¼Œæ›´æ¶µç›–äº†<code>M+N</code>çš„ç±»å‹ã€‚</font></p>
<p><font color="orange">æ³¨é‡Šï¼šé¦–å…ˆ<code>static typing environment</code>è®°å½•ç¨‹åºä¸­<code>freeÂ variable</code>çš„ç±»å‹ä¿¡æ¯-These are used to record the types of free variables during the processing of program fragments; Â  å…¶æ¬¡<code>typingÂ judgements</code>æ˜¯æ–­è¨€<code>term</code>æœ‰ç±»å‹-It asserts that a term M has a type A with respect to a static typing environment for the free variables of Mã€‚</font></p>
<p>åŸºæœ¬çš„è§„åˆ™è¡¨ç¤º<code>empty environment</code>æ˜¯<code>well formed</code>çš„ï¼Œä¸éœ€è¦å‰æï¼š <span class="math display">\[
\text{(Env âˆ…)} \\ \frac{}{\emptyset \vdash \diamond}
\]</span></p>
<blockquote>
<p>A collection of type rules is called a (formal) type system. Technically, type system fit into the general framework of <em>formal proof system</em>: collections of rules used to carry out step-by-step deductions.</p>
<p><strong>The deductions carried out in type systems concern the typing of prorgams.</strong></p>
</blockquote>
<p>æŠ€æœ¯ä¸Šè®²ï¼Œ<code>type system</code>æ»¡è¶³å½¢å¼åŒ–è¯æ˜ç³»ç»Ÿ<code>formal proof systems</code>çš„åŸºæœ¬æ¡†æ¶ï¼šä¸€ç³»åˆ—çš„<code>type rules</code>è¢«ç”¨æ¥æ‰§è¡Œä¸€æ­¥ä¸€æ­¥çš„æ¨ç†æ¼”ç»ã€‚ç±»å‹ç³»ç»Ÿæ¨ç†çš„è¿‡ç¨‹å°±æ˜¯ç¨‹åºä¸­ç±»å‹çš„æ¦‚å¿µã€‚</p>
<h4 id="type-derivations">Type derivations</h4>
<p><code>derivation</code>åœ¨<code>type system</code>ä¸­æ˜¯ä»¥<code>judgements tree</code>çš„å½¢å¼ï¼Œä¸Šé¢æ˜¯å¶å­ï¼Œæœ€åæ˜¯æ ¹â€”â€”æ¯ä¸€ä¸ª<code>judgement</code>éƒ½å¯ä»¥ä»å…¶ä¸Šé¢çš„å¶å­éƒ¨åˆ†æ ¹æ®ä¸€å®šè§„åˆ™æ¨å¯¼å¾—åˆ°ã€‚<code>type system</code>æœ€åŸºæœ¬çš„è¦æ±‚å°±æ˜¯çœ‹å…¶<code>derivation</code>æ˜¯å¦æ˜¯æ­£ç¡®æ„å»ºçš„ã€‚</p>
åœ¨ä¸€å¥—<code>type system</code>ä¸­ï¼Œèƒ½æ­£ç¡®åº”ç”¨<code>type rules</code>æ¨å¯¼å‡ºæ¥çš„ä¸€å®šæ˜¯<code>valid judgement</code>ã€‚æ¯”å¦‚ä¸‹é¢ï¼š $$
<span class="math display">\[\begin{aligned}
\dfrac{\dfrac{\dfrac{}{\emptyset \vdash \diamond}  \text{by(Env âˆ…)}}{\emptyset \vdash 1:Nat}  \text{by(Val n)} \quad \dfrac{\dfrac{}{\emptyset \vdash \diamond}  \text{by(Env âˆ…)}}{\emptyset \vdash 2:Nat}  \text{by(Val n)}}{\emptyset \vdash 1+2:Nat}  \text{by(Val +)}

\end{aligned}\]</span>
<p>$$ æ ¹æ®å‰é¢ç»™å‡ºçš„è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºæ–°çš„<code>derivation</code>å³<code>âˆ…âŠ¢1+2:Nat</code>æ˜¯<code>valid judgement</code>ã€‚å…¶ä¸­æ¯ä¸€æ­¥æ¨å¯¼ç”¨åˆ°çš„è§„åˆ™éƒ½æ ‡è®°åœ¨å³è¾¹ã€‚</p>
<h4 id="well-typing-and-type-inference">Well typing and type inference</h4>
<p>ç»™å®šä¸€ä¸ª<code>type system</code>ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªç±»å‹<code>A</code>ä½¿å¾—<code>ğšªâŠ¢M:A</code>æ˜¯æœ‰æ•ˆçš„â€”â€”é‚£ä¹ˆå¯¹äºç¯å¢ƒ<code>ğšª</code>æ¥è¯´<code>M is well typed</code>çš„ï¼Œå³<code>term M</code>è¢«èµ‹äºˆæŸä¸ªç±»å‹ã€‚</p>
<blockquote>
<p>The discovery of a derivation(and hence of a type) for a term is called the <strong>type inference</strong>.</p>
</blockquote>
<p>æ¯”å¦‚åœ¨ä¸€ä¸ªç®€å•çš„<code>type system</code>ä¸­ï¼Œå…¶æœ‰<code>rules(Env âˆ…),(Val n),(Val +)</code>ï¼Œé‚£ä¹ˆæ ¹æ®å‰é¢çš„æ¨å¯¼ï¼Œåœ¨ç©ºç¯å¢ƒ<code>empty environment</code>ä¸‹çš„<code>term 1+2</code>å¯ä»¥è¢«æ¨å¯¼å‡ºNatç±»å‹ã€‚å‡è®¾æˆ‘ä»¬ç»™è¯¥ç±»å‹ç³»ç»ŸåŠ å…¥<code>premise ğšªâŠ¢â—‡</code>å’Œ<code>conclusion ğšªâŠ¢true:Booll</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ— æ³•å¯¹<code>term true+1</code>æ¨å¯¼å‡ºä»»ä½•ç±»å‹ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰ä¸€ä¸ªå°†<code>natural</code>å’Œ<code>boolean</code>ç±»å‹ç›¸åŠ çš„<code>rule</code>ã€‚å› ä¸ºæ— æ³•æ¨å¯¼å‡º<code>1+true</code>çš„<code>derivations</code>ï¼Œæˆ‘ä»¬å°±è¯´<code>1+true</code>æ˜¯<code>not typeable</code>çš„ï¼Œæˆ–è€…è¯´å…¶å‘ç”Ÿäº†<code>typing error</code>ã€‚æˆ‘ä»¬ç»§ç»­ç»™ä¸Šè¿°ç±»å‹ç³»ç»ŸåŠ å…¥<code>premise ğšªâŠ¢M:Nat</code>å’Œ<code>conclusion ğšªâŠ¢N:Bool</code>å’Œ<code>conclusion ğšªâŠ¢M+N:Nat</code>ï¼ˆé€šè¿‡å°†trueè§£é‡Šä¸ºæ•´æ•°1ï¼‰ã€‚é‚£ä¹ˆ<code>term 1+true</code>å°†ä¼šè¢«æ¨å¯¼å‡ºä¸€ä¸ª<code>Nat</code>ç±»å‹ã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œ<code>type inference</code>éå¸¸ä¾èµ–<code>type system</code>ã€‚ä¸€ä¸ªç±»å‹æ¨å¯¼ç®—æ³•å¯ä»¥å¾ˆç®€å•ï¼Œä¹Ÿå¯ä»¥å¾ˆéš¾æˆ–è€…å‹æ ¹ä¸å¯èƒ½å®ç°ã€‚è™½ç„¶ç±»å‹ç³»ç»Ÿé€šå¸¸æ˜¯æŠ½è±¡è¡¨è¾¾è®¾è®¡ï¼Œä½†æ˜¯å…¶å®ç”¨æ€§åˆ™å®Œå…¨å–å†³äºç±»å‹æ¨å¯¼ç®—æ³•çš„å¯ç”¨æ€§ã€‚</p>
<p><code>explicitly typed languages</code>æ¯”å¦‚<code>pascal</code>çš„ç±»å‹æ¨å¯¼ç›¸å¯¹å®¹æ˜“ç®€å•ï¼Œè€Œ<code>implicitly typed languages</code>æ¯”å¦‚<code>ML</code>çš„ç±»å‹æ¨å¯¼ç›¸å¯¹æ›´å›°éš¾ä¸€äº›ã€‚ç±»å‹æ¨å¯¼çš„åŸºæœ¬æ€è·¯å¾ˆæ¸…æ™°æ˜“æ‡‚ï¼Œä½†æ˜¯çœŸæ­£å®é™…ä¸­çš„å®ç°å´ç›¸å½“å¤æ‚å¹¶ä¸”è¿˜åœ¨ç ”ç©¶ä¸­ã€‚</p>
<blockquote>
<p>Type inference problem becomes particularly hard in the presence of <strong>polymorphism.</strong></p>
</blockquote>
<p>å¯¹äº<code>explicitly typed languages</code>æ¯”å¦‚<code>Ada, CLU, ML</code>ç­‰çš„<code>polymorphic features</code>çš„<code>type inference</code>åœ¨å®è·µä¸­å¾—åˆ°äº†è§£å†³â€”â€”æ˜¯é€šè¿‡çº¯ç®—æ³•é—®é¢˜ï¼Œè€Œä¸æ˜¯åœ¨å¼•å…¥ç›¸å…³<code>type system</code>çš„åŸºç¡€ä¸Šè§£å†³çš„ã€‚<strong>è€Œå¾€å¾€æœ€çº¯ç²¹ï¼Œæœ€æ™®éçš„é’ˆå¯¹å¤šæ€çš„ç±»å‹æ¨å¯¼é—®é¢˜éƒ½æ˜¯åœ¨ğ›Œæ¼”ç®—ä¸­è®¨è®ºçš„ã€‚</strong> ç„¶è€Œè¯¥é—®é¢˜çš„ç»“å±€å´ä¾èµ–äºä¸åˆ‡å®é™…çš„å†—é•¿çš„ä¸€äº›<code>typing annotations</code>ã€‚ä¸ºäº†è®©è¯¥å¤šæ€æ–¹æ¡ˆæ›´åŠ å®é™…åŒ–ä¸€ç‚¹ï¼Œéœ€è¦çœç•¥ä¸€äº›ç±»å‹ä¿¡æ¯ã€‚è¿™ä¸ªé¢†åŸŸä¾ç„¶æ˜¯ç›®å‰å­¦æœ¯ç•Œçš„ç ”ç©¶é‡ç‚¹ã€‚</p>
<h4 id="type-soundness">Type soundness</h4>
<p>æœ€åéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>type system</code>ä¸æ˜¯ä¸€ç³»åˆ—ä»»æ„çš„<code>type rules</code>çš„å †ç§¯ã€‚<code>well-typing</code>åœ¨è¯­ä¹‰å±‚é¢å¯¹åº”ç€<code>good behavior</code>ã€‚é€šå¸¸é€šè¿‡è¯æ˜<code>type soundness theorem</code>æ¥æ£€æŸ¥ç±»å‹ç³»ç»Ÿå†…éƒ¨çš„ä¸€è‡´æ€§â€”â€”å› æ­¤ç±»å‹ç³»ç»Ÿéœ€è¦è¯­ä¹‰ä½œä¸ºåŸºç¡€ã€‚å¯¹äº<code>denotational semantics</code>æ¥è¯´å¦‚æœ<code>âˆ…âŠ¢M:A</code>æ˜¯æœ‰æ•ˆçš„ï¼Œåˆ™ã€–Mã€—âˆŠã€–Aã€—(å³Mçš„å€¼å±äºç±»å‹Aæ‰€è¡¨ç¤ºçš„é›†åˆ)ï¼Œå¯¹äº<code>operational semantics</code>æ¥è¯´å¦‚æœ<code>âˆ…âŠ¢M:A</code>æˆç«‹ï¼Œå¹¶ä¸”Mæ¨å¯¼å‡ºM'ï¼Œåˆ™<code>âˆ…âŠ¢M':A</code>æˆç«‹ã€‚å¯¹äºä¸¤ä¸ªä¾‹å­æ¥è¯´ï¼Œ<code>type soundness theorem</code>æ–­è¨€<code>well-typed</code>çš„ç¨‹åºä¸ä¼šåœ¨è®¡ç®—è¿‡ç¨‹ä¸­å‡ºç°<code>execution errors</code>ã€‚</p>
<h3 id="first-order-type-systems">First-order Type Systems</h3>
<p>åœ¨å¤§å¤šæ•°è¿‡ç¨‹é—´è¯­è¨€ä¸­å®ç°çš„<code>type system</code>ç§°ä¸º<code>first order</code>ã€‚æ ¸å¿ƒå°±æ˜¯åŒ…æ‹¬<strong>é«˜é˜¶å‡½æ•°<code>higher order functions</code></strong>ã€‚æœ€ç²¾ç®€çš„<code>first-order type system</code>å¯ä»¥ç”±<code>untyped ğ›Œ-calculus</code>è¡¨ç¤ºï¼Œå½¢å¼ä¸º<code>ğ›Œx.M</code>å³æœ‰å‚æ•°<code>x</code>å’Œè¿”å›å€¼<code>M</code>çš„åŒ¿åå‡½æ•°ã€‚</p>
<p><code>first-order typed ğ›Œ-calculus</code>è¢«ç§°ä¸ºF<sub>1</sub>ã€‚å®ƒå’Œ<code>untyped ğ›Œ-calculus</code>ä¸åŒçš„åœ°æ–¹åœ¨äºå¯¹<code>ğ›Œ-abstractions</code>åŠ ä¸Šäº†ç±»å‹ä¿¡æ¯â€”â€”<code>ğ›Œx:A.M</code>å…¶ä¸­<code>x</code>æ˜¯å‚æ•°ï¼Œ<code>A</code>æ˜¯å‚æ•°ç±»å‹ï¼Œè€Œ<code>M</code>æ˜¯å‡½æ•°ä½“ã€‚<strong>å°†<code>ğ›Œx.M</code>è½¬åŒ–ä¸º<code>ğ›Œx:A.M</code>æ˜¯å°†éç±»å‹è¯­è¨€è¿›é˜¶ä¸ºç±»å‹è¯­è¨€çš„å…³é”®æ­¥éª¤ï¼š<code>bound variables</code>è·å–åˆ°äº†ç±»å‹ä¿¡æ¯ã€‚</strong>å› ä¸ºF<sub>1</sub>æ˜¯å»ºç«‹åœ¨å‡½æ•°åŸºç¡€ä¸Šçš„ï¼Œæ‰€ä»¥å¼•å…¥<code>AâŸ¶B</code>å¸¦æœ‰å‚æ•°ç±»å‹Aå’Œè¿”å›å€¼ç±»å‹Bçš„å‡½æ•°ç±»å‹ã€‚ä»‹ç»æ„å»ºå‡½æ•°ç±»å‹æ‰€éœ€çš„åŸºæœ¬ç±»å‹ï¼šå¼•å…¥<code>Basic</code>è¡¨ç¤ºè¯¥ç±»å‹é›†åˆï¼Œå¼•å…¥<code>KâˆŠBasic</code>è¡¨ç¤ºé›†åˆä¸­çš„ä»»ä½•ä¸€ä¸ªè¯¥ç±»å‹ã€‚</p>
<h4 id="syntax-of-f1">Syntax of F<sub>1</sub></h4>
<blockquote>
<p>A,B ::= types</p>
<p>â€‹ K KâˆŠBasic basic types</p>
<p>â€‹ AâŸ¶B function types</p>
<p>M,N ::= terms</p>
<p>â€‹ x variable</p>
<p>â€‹ ğ›Œx:A.M function</p>
<p>â€‹ M N application</p>
</blockquote>
<p>F<sub>1</sub>çš„è¯­æ³•å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚è¿™é‡Œæœ‰å¿…è¦ç®€å•è¯´æ˜ä¸€ä¸‹<code>typed language</code>çš„è¯­æ³•ã€‚å¯¹äº<code>untyped language</code>æ¥è¯´<code>context-free syntax</code>å°±å¯ä»¥å®Œæ•´æè¿°æ•´ä¸ªè¯­è¨€ã€‚è€Œå¯¹äº<code>typed language</code>æ¥è¯´å´ä¸å¤Ÿï¼›<font color="red"><code>typed language</code>ä¸ä»…ä»…éœ€è¦<code>type system</code>æ¥å®Œå–„ç¨‹åºè¯­è¨€çš„<code>legality</code>ï¼Œè¿˜éœ€è¦<code>context-free syntax</code>æ¥è¡¨ç¤ºå®šä¹‰<code>free/bound variable</code>æ¦‚å¿µâ€”â€”å³å®šä¹‰ç¨‹åºè¯­è¨€çš„<code>scoping rules</code>ã€‚</font>åœ¨ä½œç”¨åŸŸçš„åŸºç¡€ä¸Šï¼Œé‚£äº›åªæœ‰<code>bound variable</code>ä¸åŒçš„<code>term</code>ä¼šè¢«ç§°ä¸ºæ˜¯è¯­æ³•ä¸Šç›¸åŒçš„<code>syntactically identical</code>æ¯”å¦‚<code>ğ›Œx:K.x</code>å’Œ<code>ğ›Œy:K.y</code>ã€‚</p>
<h4 id="basic-of-f1">Basic of F<sub>1</sub></h4>
<p>F<sub>1</sub>éœ€è¦ä¸‰ä¸ª<code>judgements</code>å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr class="header">
<th>ğšªâŠ¢â—‡</th>
<th>ğšª is a well-formed environment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ğšªâŠ¢A</td>
<td>A is a well-formed type in ğšª</td>
</tr>
<tr class="even">
<td>ğšªâŠ¢M:A</td>
<td>M is a well-formed term of type A in ğšª</td>
</tr>
</tbody>
</table>
<p>å…¶ä¸­<code>ğšªâŠ¢A</code>æœ‰ç‚¹å†—ä½™ï¼Œå› ä¸ºæ‰€æœ‰è¯­æ³•ä¸Šæ­£ç¡®çš„ç±»å‹<code>A</code>åœ¨ä»»ä½•ç¯å¢ƒ<code>ğšª</code>ä¸‹éƒ½æ˜¯<code>well-formed</code>çš„ã€‚è€Œåœ¨<code>second-order</code>ç³»ç»Ÿä¸­ï¼Œç±»å‹çš„<code>well-formed</code>å°±ä¸å•å•å–å†³äºè¯­æ³•äº†ï¼Œè¿™æ—¶å€™<code>ğšªâŠ¢A</code>å°±å¾ˆé‡è¦äº†ã€‚è¯æ˜è¿™äº›<code>judgement</code>çš„æœ‰æ•ˆæ€§çš„<code>type rules</code>åœ¨ä¸‹é¢è¡¨æ ¼ä¸­ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{(Env âˆ…)} \qquad &amp;&amp;\text{(Env x)} \\ 
&amp;\frac{}{\emptyset \vdash \diamond} \qquad &amp;&amp;\frac{\Gamma \vdash A \quad x\notin dom(\Gamma)}{\Gamma,x:A\vdash \diamond} \\ \\
&amp;\text{(Type Const)}  &amp;&amp;\text{(Type Arrow)} \\
&amp;\frac{\Gamma \vdash \diamond \quad K\in Basic}{\Gamma \vdash K} &amp;&amp;\frac{\Gamma \vdash A \quad \Gamma \vdash B}{\Gamma \vdash A\to B} \\ \\
&amp;\text{(Val x)} &amp;&amp;\text{(Val fun)} &amp;&amp;&amp;\text{(Val Appl)} \\
&amp;\frac{\Gamma^{&#39;},x:A,\Gamma^{&#39;&#39;}\vdash \diamond}{\Gamma^{&#39;},x:A,\Gamma^{&#39;&#39;}\vdash x:A} &amp;&amp;\frac{\Gamma, x:A\vdash M:B}{\Gamma \vdash \lambda x:A.M:A\to B} &amp;&amp;&amp;\frac{\Gamma \vdash M:A\to B \quad \Gamma \vdash N:A}{\Gamma \vdash MN:B}
\end{aligned}
\]</span> å…¶ä¸­è§„åˆ™<code>Env âˆ…</code>æ˜¯å”¯ä¸€ä¸éœ€è¦å‰æçš„ï¼šç©ºç¯å¢ƒ<code>empty environment</code>æ˜¯æœ‰æ•ˆçš„ç¯å¢ƒã€‚è§„åˆ™<code>Env x</code>ç”¨æ¥å°†ç¯å¢ƒ<code>ğšª</code>æ‰©å±•åˆ°èŒƒå›´æ›´å¤§çš„æœ‰æ•ˆç¯å¢ƒğšª,<code>x:A</code>â€”â€”å‰ææ˜¯<code>A</code>åœ¨<code>ğšª</code>ä¸­æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç±»å‹ã€‚æ³¨æ„åˆ°å¯¹å‰æ<code>ğšªâŠ¢A</code>åº”ç”¨å½’çº³åŸåˆ™å°±éœ€è¦<code>ğšª</code>æ˜¯åˆæ³•çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¿…é¡»ç”±<code>ğšªâŠ¢â—‡</code>æ¨å¯¼å‡º<code>ğšªâŠ¢A</code>ã€‚å¦ä¸€ä¸ªå‰ææ˜¯å˜é‡<code>x</code>ä¸èƒ½åœ¨ç¯å¢ƒ<code>ğšª</code>ä¸­è¢«ä½¿ç”¨<font color="blue">must not be defined.</font>ã€‚æˆ‘ä»¬åº”è¯¥æ˜ç¡®åœ¨ç¯å¢ƒä¸­çš„æ‰€æœ‰ä¸åŒå˜é‡ï¼Œæ¯”å¦‚å½“<code>ValFun</code>è§„åˆ™ä¸­çš„å‰æ<code>ğšª,x:AâŠ¢M:B</code>è¢«æ¨å¯¼æ—¶ï¼ˆå‡ºç°åœ¨æ°´å¹³çº¿ä¸‹é¢ï¼‰ï¼Œ<code>x</code>å°±ä¸èƒ½å‡ºç°åœ¨<code>dom(ğšª)</code>ä¸­ã€‚</p>
<p>è§„åˆ™<code>Type Const</code>å’Œ<code>Type Arrorw</code>ç”¨æ¥æ„å»ºç±»å‹ã€‚è§„åˆ™<code>Val x</code>ä½¿ç”¨éæ­£å¼çš„<code>ğšª',x:A,ğšª''</code>è¡¨ç¤º<code>x:A</code>åœ¨ç¯å¢ƒä¸­çš„ä»»æ„åœ°æ–¹å‡ºç°ã€‚è§„åˆ™<code>Val Fun</code>å¯¹å‡½æ•°<code>ğ›Œx:A.M</code>èµ‹å€¼äº†<code>AâŸ¶B</code>ç±»å‹ï¼Œå‰ææ˜¯é¦–å…ˆå‚æ•°æœ‰<code>A</code>ç±»å‹ä¹‹åï¼Œå‡½æ•°ä½“è¢«èµ‹äºˆäº†<code>B</code>ç±»å‹ã€‚è¦æ³¨æ„è¯¥è§„åˆ™ä¸­<code>environment</code>æ˜¯å¦‚ä½•æ”¹å˜é•¿åº¦çš„ã€‚<code>Val Appl</code>è§„åˆ™å°†å‚æ•°ä¼ ç»™å‡½æ•°æ±‚å€¼ã€‚ä¸‹é¢å±•ç¤ºäº†F<sub>1</sub>æ‰€æœ‰çš„<code>derivation</code>ï¼š</p>
<p><img src="1.png" width="50%" height="50%" alt=""></p>
<h4 id="expansion-of-f1">Expansion of F<sub>1</sub></h4>
<p>ç°åœ¨æ—¢ç„¶äº†è§£è¿‡äº†ç®€å•çš„<code>first-order type system</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸°å¯Œå…¶å†…å®¹æ¥å°†å…¶æ‰“é€ æˆä¸ºä¸€ä¸ªç°å®è¯­è¨€çš„ç±»å‹ç³»ç»Ÿã€‚æˆ‘ä»¬è¦ä¸ºæ¯ä¸€ä¸ªæ–°æ·»åŠ çš„ç±»å‹æ„é€ æ·»åŠ ä¸€ç»„<code>rules</code>ã€‚æˆ‘ä»¬é¦–å…ˆå¼•å…¥ä¸€äº›åŸºç¡€ç±»å‹ï¼š<code>Unit Type</code>å…¶å€¼å°±æ˜¯å¸¸æ•°<code>constant unit</code>ï¼›<code>Bool Type</code>å…¶å€¼å°±æ˜¯<code>true or false</code>ï¼›<code>Nat Type</code>å…¶å€¼æ˜¯è‡ªç„¶æ•°ã€‚</p>
<h5 id="unit-type">Unit Type</h5>
<p><code>Unit Type</code>ç»å¸¸ç”¨æ¥å¡«å……ä¸€äº›ç©ºå‚æ•°å’Œç»“æœæ¯”å¦‚æŸäº›è¯­è¨€ä¸­çš„<code>Void/Null</code>ã€‚è¯¥ç±»å‹æ²¡æœ‰æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€æ¡è§„åˆ™é™ˆè¿°<code>Unit</code>æ˜¯åˆæ³•çš„ç±»å‹ï¼Œå€¼<code>unit</code>æ˜¯ç±»å‹<code>Unit</code>çš„åˆæ³•å€¼å³å¯ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{(Type Unit)} \quad &amp;&amp;\text{(Val Unit)} \\
&amp;\frac{\Gamma \vdash \diamond}{\Gamma \vdash Unit} \quad &amp;&amp; \frac{\Gamma \vdash \diamond}{\Gamma \vdash unit:Unit}
\end{aligned}
\]</span></p>
<h5 id="bool-type">Bool Type</h5>
<code>Type Bool</code>ä¹Ÿæœ‰ç›¸ä¼¼ç»“æ„çš„è§„åˆ™ï¼Œä¸åŒçš„æ˜¯<code>booleans</code>æœ‰ä¸€ä¸ªå®é™…æ“ä½œâ€”â€”<code>condition</code>ã€‚åœ¨è§„åˆ™<code>Val Cond</code>ä¸­ï¼Œå…¶ä¸¤ä¸ªåˆ†æ”¯éƒ½å¿…é¡»æœ‰ç›¸åŒçš„ç±»å‹ï¼Œè¿™æ˜¯å› ä¸ºè¿™ä¸¤ä¸ªéƒ½æœ‰å¯èƒ½æˆä¸ºç»“æœæ‰€ä»¥éœ€è¦ä¿æŒä¸€è‡´ã€‚<br>
$$
<span class="math display">\[\begin{aligned}
&amp;\text{(Type Bool)}  &amp;&amp;\text{(Val True)}  \\
&amp;\frac{\Gamma \vdash \diamond}{\Gamma \vdash Bool} \quad &amp;&amp; \frac{\Gamma \vdash \diamond}{\Gamma \vdash true:Bool} \quad  \\\\

 &amp;\text{(Val False)} &amp;&amp;\text{(Val Cond)} \\
&amp;\frac{\Gamma \vdash \diamond}{\Gamma  \vdash false:Bool} &amp;&amp; \frac{\Gamma \vdash M:Bool \quad \Gamma \vdash N_1:A \quad \Gamma \vdash N_2:A}{\Gamma \vdash (if_A \text{M then} N_1 \text{else} N_2):A}
\end{aligned}\]</span>
<p>$$ è§„åˆ™<code>Val Cond</code>å¼•å‡ºäº†ä¸€ä¸ªåœ¨<code>typechecking</code>çš„æ—¶å€™éœ€è¦ç”¨åˆ°çš„ç±»å‹ä¿¡æ¯çš„é—®é¢˜ã€‚å½“é‡åˆ°æ¡ä»¶è¯­å¥çš„æ—¶å€™ï¼Œä¸€èˆ¬<code>typechecker</code>ä¼šåˆ†åˆ«æ¨æ–­N<sub>1</sub>å’ŒN<sub>2</sub>çš„ç±»å‹ï¼Œç„¶ååœ¨æ‰¾åˆ°ä¸€ä¸ªå’Œå‰é¢æ‰¾åˆ°çš„ä¸¤ä¸ªç±»å‹å…¼å®¹çš„ç±»å‹Aã€‚åœ¨ä¸€äº›ç±»å‹ç³»ç»Ÿä¸­è¿™ç§æ¨æ–­ä¸æ˜¯å¾ˆå®¹æ˜“è¿›è¡Œï¼Œå› æ­¤ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹æ ‡ç±»å‹<code>suubstripted type</code>æ¥è¡¨ç¤ºé¢å¤–å¢åŠ çš„ç±»å‹ä¿¡æ¯ï¼šif<sub>A</sub>å°±æ˜¯<code>typechecker</code>çš„æç¤ºï¼šæœ€ç»ˆç±»å‹å¯èƒ½æ˜¯Aï¼Œè€Œä»N<sub>1</sub>å’ŒN<sub>2</sub>æ¨æ–­å‡ºæ¥çš„ç±»å‹ä¿¡æ¯éœ€è¦å’Œå…¶åšæ¯”è¾ƒã€‚ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬éƒ½ä¼šä½¿ç”¨ä¸‹æ ‡ç±»å‹æ¥è¡¨ç¤ºå¯èƒ½ä¼šæœ‰ç”¨çš„ä¸€äº›ç±»å‹ä¿¡æ¯ï¼Œä½†æ˜¯ç›®å‰æ¯”è¾ƒæˆç†Ÿçš„<code>typechecker</code>éƒ½ä¼šè‡ªå·±åˆæˆè¯¥ç±»å‹ä¿¡æ¯ï¼Œå› æ­¤å…¶å¯ä»¥çœç•¥æ‰ã€‚</p>
<h5 id="nat-type">Nat Type</h5>
<p>è‡ªç„¶æ•°çš„ç±»å‹<code>Nat Type</code>å¯ä»¥é€šè¿‡0å’Œ<code>succ</code>çš„è§„åˆ™éƒ½æ¨å¯¼å‡ºæ¥ã€‚åœ¨è¯¥ç±»å‹ä¸Šçš„æ“ä½œé€šè¿‡<code>pred</code>å’Œ<code>isZero</code>(æµ‹è¯•é›¶å€¼)åŸè¯­å˜çš„å¯èƒ½ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{(Type Nat)} \quad &amp;&amp;\text{(Val Zero)} \quad &amp;&amp;&amp;\text{(Val Succ)} \\
&amp;\frac{\Gamma \vdash \diamond}{\Gamma \vdash Nat} &amp;&amp; \frac{\Gamma \vdash \diamond}{\Gamma \vdash 0:Nat} &amp;&amp;&amp;\frac{\Gamma \vdash M:Nat}{\Gamma \vdash succ M:Nat} \\\\
&amp;\text{(Val Pred)} &amp;&amp;\text{(Val IsZero)} \\
&amp;\frac{\Gamma \vdash M:Nat}{\Gamma \vdash pred M:Nat} &amp;&amp;\frac{\Gamma \vdash M:Nat}{\Gamma \vdash isZero M:Bool}
\end{aligned}
\]</span></p>
<h5 id="product-type">Product Type</h5>
<p>æ—¢ç„¶æˆ‘ä»¬æœ‰äº†ä¸€ç³»åˆ—åŸºæœ¬ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€äº›ç»“æ„åŒ–ç±»å‹ï¼Œä»<code>product Type</code>å¼€å§‹ï¼Œä¸€ä¸ª<code>product Type</code> A<sub>1</sub>XA<sub>2</sub>è¡¨ç¤ºä¸¤ä¸ªç±»å‹åˆ†åˆ«æ˜¯A<sub>1</sub>å’ŒA<sub>2</sub>çš„å…ƒç´ ç»„æˆçš„å€¼å¯¹çš„ç±»å‹ã€‚è¿™ä¸¤ä¸ªå…ƒç´ å¯ä»¥åˆ†åˆ«è¢«æŠ•å½±ä¸º<code>projections first</code>å’Œ<code>projections second</code>ã€‚æˆ–è€…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>with</code>è¯­å¥ï¼Œå°†ä¸€ä¸ª<code>pair M</code>åˆ†è§£ï¼Œå¹¶å°†å…¶ä¸¤ä¸ªå…ƒç´ ç»‘å®šåœ¨ä½œç”¨åŸŸNä¸‹çš„ä¸¤ä¸ªå˜é‡v<sub>1</sub>å’Œv<sub>2</sub>ä¸Šã€‚<strong><code>with</code>è¯­å¥å¯¹åº”ç€<code>ML</code>è¯­è¨€ä¸­çš„<code>pattern matching</code>å’Œ<code>pascal</code>è¯­è¨€ä¸­çš„<code>with</code></strong>ï¼›</p>
<p><code>product Type</code>è¿˜å¯ä»¥é€šè¿‡ç›¸å¯¹åº”çš„<code>projections</code>å’Œ<code>with</code>è¢«ç”¨æ¥æ„å»º<code>tuple Type</code>A<sub>1</sub>XA<sub>2</sub>...XA<sub>i</sub>ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{(Type Product)} \quad &amp;&amp;\text{(Val Pair)} \\
&amp;\frac{\Gamma \vdash A_1 \quad \Gamma \vdash A_2}{\Gamma \vdash A_1 \times A_2} &amp;&amp; \frac{\Gamma \vdash M_1:A_1 \quad \Gamma \vdash M_2:A_2}{\Gamma \vdash \langle M_1,M_2 \rangle:A_1 \times A_2} \\\\
&amp;\text{(Val First)} \quad &amp;&amp;\text{(Val Second)} \\
&amp;\frac{\Gamma \vdash M: A_1 \times A_2}{\Gamma \vdash firstM:A_1} &amp;&amp;\frac{\Gamma \vdash M:A_1 \times A_2}{\Gamma \vdash second M:A_2} \\\\
&amp;\text{(Val  With)} \\
&amp; \frac{\Gamma \vdash M:A_1 \times A_2 \quad \Gamma ,x_1:A_1,x_2:A_2\vdash N:B}{\Gamma \vdash (with(x_1:A_1,x_2:A_2):=M do N):B}
\end{aligned}
\]</span></p>
<h5 id="union-type">Union Type</h5>
<code>Type Union</code>ç»å¸¸è¢«å¿½è§†ï¼Œä½†å…¶å’Œ<code>product Type</code>ä¸€æ ·é‡è¦ã€‚ä¸€ä¸ª<code>union</code>:A<sub>1</sub>+A<sub>2</sub>çš„å…ƒç´ å¯ä»¥è¢«çœ‹æˆæ˜¯æœ‰å·¦æ ‡è®°çš„A<sub>1</sub>ç±»å‹ï¼ˆ<code>tagged with a left token</code>ï¼‰ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæœ‰å³æ ‡è®°çš„A<sub>2</sub>ç±»å‹ã€‚è¿™é‡Œçš„æ ‡è®°å¯ä»¥è¢«<code>isLeft/isRight</code>æ£€æµ‹å…¶ç±»å‹ç»“æœåˆ†åˆ«æ˜¯<code>asLeft/asRight</code>ã€‚å¦‚æœ<code>asLeft</code>è¢«é”™è¯¯çš„èµ‹ç»™<code>right-tagged</code>çš„å€¼ï¼Œé‚£ä¹ˆ<code>trapped error</code>å°±ä¼šå‘ç”Ÿã€‚ä½†æ˜¯è¿™ä¸ªé”™è¯¯å¹¶ä¸æ˜¯<code>forbidden error</code>ã€‚å› ä¸ºå‡å®š<code>asLeft</code>æœ‰A<sub>1</sub>ç±»å‹çš„æƒ…å†µéƒ½æ˜¯<code>safe</code>çš„ã€‚è§„åˆ™<code>Val Case</code>è¡¨è¿°äº†ä¸€ç§ä¼˜é›…çš„å¯ä»¥æ›¿æ¢<code>isLeft/isRight/asLeft/asRight</code>çš„æ„é€ æ–¹å¼å’Œå…¶ç›¸åº”çš„<code>trapped errors</code>ã€‚å…¶è¿˜æ¶ˆé™¤äº†<code>union</code>å¯¹<code>Bool</code>ç±»å‹çš„ä¾èµ–ã€‚caseæ„é€ æ ¹æ®Mçš„æ ‡è®°æ‰§è¡Œä¸¤ä¸ªåˆ†æ”¯ä¸­çš„ä¸€ä¸ªï¼ŒMçš„æœªæ ‡è®°å†…å®¹åˆ†åˆ«ç»‘å®šåˆ°N<sub>1</sub>æˆ–N<sub>2</sub>èŒƒå›´å†…çš„x<sub>1</sub>æˆ–x<sub>2</sub>ã€‚ $$
<span class="math display">\[\begin{aligned}
&amp;\text{(Type Union)}  \\
&amp;\frac{\Gamma \vdash A_1 \quad \Gamma \vdash A_2}{\Gamma \vdash A_1+A_2} \\\\
 &amp; \text{(Val inLeft)} &amp;&amp;\text{(Val inRight)} \\
&amp; \frac{\Gamma \vdash M_1:A_1 \quad \Gamma \vdash A_2}{\Gamma \vdash inLeft_{A_{2}}M_1:A_1+A_2} &amp;&amp; \frac{\Gamma \vdash A_1 \quad  \Gamma \vdash M_2:A_2}{\Gamma \vdash inRight_{A_{1}}M_2:A_1+A_2} \\\\

&amp;\text{(Val isLeft)} &amp;&amp;\text{(Val isRight)} \\
&amp;\frac{\Gamma \vdash M:A_1+A_2}{\Gamma \vdash isLeft M:Bool}
&amp;&amp;\frac{\Gamma \vdash M:A_1+A_2}{\Gamma \vdash isRight M:Bool} \\\\

&amp;\text{(Val asLeft)} &amp;&amp;\text{(Val asRight)} \\
&amp;\frac{\Gamma \vdash M:A_1+A_2}{\Gamma \vdash asLeft M:A_1} 
&amp;&amp;\frac{\Gamma \vdash M:A_1+A_2}{\Gamma \vdash asRight M:A_2} \\\\


&amp;\text{(Val Case)} \\
&amp;\frac{\Gamma \vdash M:A_1+A_2 \quad \Gamma,x_1:A_1 \vdash N_1:B \quad \Gamma,x_2:A_2\vdash N_2:B}{\Gamma \vdash (case_B Mofx_1:A_1 thenN_1|x_2:A_2thenN_2):B}
\end{aligned}\]</span>
<p>$$ åœ¨ç¨‹åºè¡¨è¾¾æ–¹é¢è€Œä¸æ˜¯å®ç°æ–¹é¢ï¼Œæ³¨æ„<code>Bool Type</code>å¯ä»¥è¢«å®šä¹‰ä¸º<code>Unit + Unit</code>ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹<code>case</code>çš„æ„é€ å°±ä¼šç®€åŒ–æˆä¸º<code>condition</code>æ„é€ ã€‚<code>Int Type</code>å¯ä»¥è¢«å®šä¹‰ä¸ºä¸€ä¸ªæ­£æ•°<code>Nat</code>ç±»å‹åŠ ä¸Šä¸€ä¸ªè´Ÿæ•°<code>Nat</code>ç±»å‹ã€‚</p>
<h5 id="record-type">Record Type</h5>
<p><code>Product Type</code>å’Œ<code>Union Type</code>ç±»å‹å¯ä»¥è¿›ä¸€æ­¥è¿­ä»£æˆä¸º<code>tuple Type</code>å’Œ<code>multiple unions Type</code>ã€‚ä½†æ˜¯è¿™ä¸¤ç§æ„é€ å¤ªå¤æ‚è€Œä¸”ä¸å¤ªå¸¸å‡ºç°åœ¨ç°ä»£è¯­è¨€ä¸­ã€‚è€Œå¦ä¸€ä¸­å½¢å¼<code>labeld</code>çš„<code>product and union</code>ç»å¸¸è¢«ç”¨åˆ°ï¼š<code>record Type</code>å’Œ<code>Variant Type</code>ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{(Type Record)} (l_i \ distinct)  \\
&amp;\frac{\Gamma \vdash A_1 \quad ... \quad \Gamma \vdash A_n}{\Gamma \vdash Record(l_1:A_1,...,l_n:A_N)} \\\\&amp; \text{(Val Record)} (l_i \ distinct)   \\&amp;\frac{\Gamma \vdash M_1:A_1 \quad ... \quad \Gamma \vdash M_n:A_n}{\Gamma \vdash record(l_1=M_1,...,l_n=M_n):Record(l_1:A_1,...,l_n:A_n)} \\\\
&amp;text{Val Record Select} \\
&amp;\frac{\Gamma \vdash M:Record(l_1:A_1,...,l_n:A_n) \quad j\in 1...n}{\Gamma \vdash M.l_j:A_j} \\\\
&amp;\text{Val Record With} \\
&amp;\frac{\Gamma \vdash M:Record(l_1:A_1,...,l_n:A_n)  \qquad \Gamma,x_1:A_1,...x_n:A_n \vdash N:B}{\Gamma \vdash (with(l_1=x_1:A_1,...,l_n=x_n:A_n):MdoN):B}
\end{aligned}
\]</span> <code>record</code>ç±»å‹å¯ä»¥é€šè¿‡åç§°æ¥å®ç°æå–å…ƒç´ ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å°†å¤šä¸ª<code>product</code>ç±»å‹å¹¶èµ·æ¥ã€‚å…¶è§„åˆ™éƒ½æ˜¯ä»è¯­æ³•å±‚é¢æŒ‰ç…§å…¶å…ƒç´ å„è‡ªçš„ç±»å‹å°†å…¶è¿›è¡Œé‡ç»„ã€‚ä¸€ä¸ª<code>product</code>ç±»å‹A<sub>1</sub>XA<sub>2</sub>å¯ä»¥è¢«å®šä¹‰ä¸º<code>Record</code>ç±»å‹(first:A<sub>1</sub>, second:A<sub>2</sub>)ã€‚</p>
<h5 id="variant-type">Variant Type</h5>
<p><code>Variant Type</code>å°±æ˜¯å¤æ‚ç‰ˆçš„<code>Union Type</code>ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{(Type Variant)} (l_i \ distinct)  \\
&amp;\frac{\Gamma \vdash A_1 \quad ... \quad \Gamma \vdash A_n}{\Gamma \vdash Variant(l_1:A_1,...,l_n:A_n)} \\\\&amp;\text{(Val Variant)} (l_i \ distinct) \\&amp; \frac{\Gamma \vdash A_1 \quad ... \quad \Gamma \vdash A_n \qquad \Gamma \vdash M_j:A_j \quad j\in1...n}{\Gamma \vdash variant_{l_1:A_1,...,l_n:A_n}(l_j=M_j):Variant(l_1:A_1,...,l_n:A_n)} \\\\
&amp;\text{(Val Variant Is)} \\
&amp;\frac{\Gamma \vdash M:Variant(l_1:A_1,...,l_n:A_n) \qquad j\in1...n}{\Gamma \vdash M as l_j:A_j} \\\\
&amp;\text{(Val Variant As)} \\
&amp;\frac{\Gamma \vdash M:Variant(l_1:A_1,...,l_n:A_n \qquad j\in1...n)}{\Gamma \vdash Misl_j:Bool} \\\\
&amp;\text{Val Variant Case} \\
&amp;\frac{\Gamma \vdash M:Variant(l_1:A_1,...,l_n:A_n) \qquad \Gamma,x_1:A_1\vdash N_1:B \quad ... \quad \Gamma,x_n:A_n \vdash N_n:B}{\Gamma \vdash (case_B M of l_1=x_1:A_1 then N_1 | ...|l_n=x_n:A_nthen N_n):B}
\end{aligned}
\]</span> <code>Union Type</code>A<sub>1</sub>+A<sub>1</sub>å¯ä»¥è¢«å®šä¹‰ä¸º<code>Variant</code>(left:A<sub>1</sub>,right:A<sub>2</sub>)ã€‚å¦å¤–<code>Enumeration Types</code>æ¯”å¦‚<code>{red, green, blue}</code>å¯ä»¥è¢«å®šä¹‰ä¸º<code>Variant</code>(red:Unit, green:Unit,blue:Unit)ã€‚å…¶ä¸­<code>Is</code>è§„åˆ™æ˜¯<code>isLeft/isRight</code>ï¼Œï¼Œè€Œ<code>As</code>è§„åˆ™æ˜¯<code>asLeft/asRight</code>ï¼Œä½†æ˜¯å¦‚æœç›´æ¥ä½¿ç”¨<code>union</code>è§„åˆ™çš„è¯å°±éœ€è¦<code>case</code>å¤„ç†å¤šä¸ªåˆ†æ”¯ã€‚</p>
<h5 id="reference-type">Reference Type</h5>
<p><code>Reference Type</code>å¯ä»¥è¢«ç”¨æ¥å¤„ç†å‘½ä»¤å¼è¯­è¨€ä¸­çš„<code>mutable locations</code>çš„åŸºæœ¬ç±»å‹ã€‚<code>Ref(A)</code>çš„ä¸€ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªåŒ…å«ç±»å‹Açš„å¯å˜åœ°å€ã€‚æ–°åœ°å€å¯ä»¥è¢«<code>Val Ref</code>åˆ†é…ï¼Œæˆ–è€…è¢«<code>Val Assign</code>è§„åˆ™æ›´æ–°ï¼Œæˆ–è€…ä½¿ç”¨<code>Val Deref</code>è¿›è¡Œè§£å¼•ç”¨ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{(Type Ref)}  &amp;&amp;\text{(Val Ref)}  \\
&amp;\frac{\Gamma \vdash A}{\Gamma \vdash RefA} &amp;&amp; \frac{\Gamma \vdash M:A}{\Gamma \vdash refM:RefA} \\\\
&amp;\text{(Val Deref)} &amp;&amp;\text{(Val Assign)} \\
&amp;\frac{\Gamma \vdash M:RefA}{\Gamma \vdash derefM:A} &amp;&amp;\frac{\Gamma \vdash M:RefA \qquad \Gamma \vdash N:A}{\Gamma \vdash M:=N:Unit}
\end{aligned}
\]</span> <font color="red">å› ä¸ºèµ‹å€¼è¯­å¥çš„ç›®çš„æ˜¯ä¸ºäº†äº§ç”Ÿ<code>sideÂ effect</code>ï¼Œæ‰€ä»¥å…¶å€¼å°±å¿…é¡»æ˜¯<code>unit</code>-. Since the main purpose of an assignment is to perform a side effect, its resulting value is chosen to be unit</font></p>
<p>ä¸€äº›å¸¸è§„çš„<code>mutable</code>ç±»å‹ä¹Ÿå¯ä»¥ä»<code>Ref</code>ç±»å‹ä¸­æ´¾ç”Ÿå‡ºæ¥ï¼Œæ¯”å¦‚<code>Mutable record types</code>å°±æ˜¯ä¸€ä¸ªåŒ…å«ç€<code>Ref</code>ç±»å‹çš„<code>record</code>ç±»å‹ã€‚</p>
<h5 id="array-type">Array Type</h5>
<p><code>array</code>å’Œ<code>array</code>æ“ä½œä½¿ç”¨äº†ä¸€äº›<code>arithmetic primitives and local let declarations</code>ç­‰ã€‚æ¯”è¾ƒå¤æ‚æ„é€ çš„è§„åˆ™å¯ä»¥é€šè¿‡ç®€å•æ„é€ çš„è§„åˆ™æ¨å¯¼å‡ºæ¥ã€‚ä¸‹é¢ç»™å‡º<code>arrays</code>çš„å®ç°è¿‡ç¨‹ï¼š <span class="math display">\[
\begin{aligned}
Array&amp;(A) \quad \triangleq  &amp;&amp; \text{Array type} \\
&amp;Nat \times(Nat\to Ref(A)) &amp;&amp;\text{a bound plus a map from indices} \text{less than the bound to refs} \\
array_A&amp;(N,M) \triangleq  &amp;&amp; \text{Array constructor(for N refs initialized to M)} \\
&amp;let \ cell_0:Ref(A) = \\ &amp;ref(M)and...and\ \\ &amp;cell_{N-1}:Ref(A)=ref(M).\\
&amp;in \langle N,\lambda x:Nat.\ if\ x=0 \\
&amp;\ then \ cell_0\ else\ if\ ...\ else\ \\ &amp;if\ x=N-1\ then\ cell_{N-1}\ \\&amp;else\ error_{Ref_{(A)}}.\rangle \\
bound&amp;(M) \triangleq &amp;&amp; \text{Array bound} \\
&amp;first \ M \\
M[N]_A &amp;\triangleq &amp;&amp; \text{Array indexing} \\
&amp;if\ N\ &lt;\ first\ M \\
&amp;then\ deref\ ((second\ M)(N)) \\
&amp;else \ error_A\\
M[N]:&amp;=P\ \triangleq &amp;&amp;\text{Array update} \\
&amp;if\ N\ &lt;\ first\ M \\
&amp;then\ ((second\ M)(N)):=P \\
&amp;else\ error_Unit
\end{aligned}
\]</span> ä¸‹é¢ç»™å‡º<code>Array</code>ç±»å‹çš„è§„åˆ™ï¼š <span class="math display">\[
\begin{aligned}
&amp;\text{(Type Array)} \\
&amp;\frac{\Gamma \vdash A}{\Gamma \vdash Array(A)} \\\\
&amp;\text{(Val Array)} &amp;&amp;\text{(Val Array Bound)}\\
&amp;\frac{\Gamma \vdash N:Nat \quad \Gamma \vdash M:A}{\Gamma \vdash array(N,M):Array(A)} &amp;&amp;\frac{\Gamma \vdash M:Array(A)}{\Gamma \vdash bound\ M:Nat} \\\\
&amp;\text{(Val Array Index)} &amp;&amp;\text{(Val Array Update)} \\
&amp;\frac{\Gamma \vdash N:Nat \quad \Gamma \vdash M:Array(A)}{\Gamma \vdash M[N]:A} &amp;&amp;\frac{\Gamma \vdash N:Nat \quad \Gamma \vdash M:Array(A) \quad \Gamma \vdash P:A}{\Gamma \vdash M[N]:=P:Unit}
\end{aligned}
\]</span></p>
<h5 id="recursive-type">Recursive Type</h5>
<p>åœ¨å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œç±»å‹å¯ä»¥è¢«é€’å½’å®šä¹‰ã€‚<code>Recursive Types</code>è®©å…¶ä»–ç±»å‹çš„æ„é€ å˜çš„æ›´åŠ æœ‰ç”¨ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ä¼šæ˜¾å¼å®šä¹‰å‡ºæ¥ï¼Œæ•…å…¶å½¢å¼åŒ–æ–¹å¼éå¸¸ç‰¹æ®Šã€‚</p>
<p>å¤„ç†é€’å½’ç±»å‹éœ€è¦å¯¹F<sub>1</sub>åŸºç¡€éƒ¨åˆ†åšä¸€äº›å¢åŠ ï¼Œ<code>environments</code>éœ€è¦åŠ å…¥<code>type variables X</code>ã€‚è¿™ä¸ªç±»å‹å˜é‡çš„å½¢å¼æ˜¯<code>ğ›X.A</code>ï¼Œä»£è¡¨äº†å¯¹é€’å½’è¡¨è¾¾å¼<code>X=A(X may occur in A)</code>çš„ä¸€ç§æŠ½è±¡ã€‚<code>fold/unfold</code>æ“ä½œåˆ†åˆ«æ˜ å°„é€’å½’ç±»å‹åŠå…¶åŒå‹<code>ğ›X.A/[ğ›X.A/X]A</code>ï¼ˆæ¯”å¦‚<code>[B/X]A</code>æ„ä¸ºå°†åœ¨Aä¸­çš„è‡ªç”±å‡ºç°çš„Xéƒ½æ›¿æ¢æˆä¸ºBï¼‰ã€‚è¿™äº›æ“ä½œå¹¶æ²¡æœ‰è¿è¡Œæ—¶èŠ±é”€ï¼Œå› æ­¤åœ¨è¯­æ³•ä¸­ä¹Ÿç»å¸¸è¢«å¿½ç•¥ï¼Œä½†æ˜¯å…¶å­˜åœ¨ä½¿å¾—å½¢å¼åŒ–å¤„ç†å˜å¾—æ›´åŠ ä¾¿æ·ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\text{(Env X)} &amp;&amp;\text{(Type Rec)} \\
&amp;\frac{\Gamma \vdash \diamond \quad X \notin dom(\Gamma)}{\Gamma,X\vdash \diamond} &amp;&amp;\frac{\Gamma,X\vdash A}{\Gamma \vdash \mu X.A} \\\\
&amp;\text{(Val Fold)} &amp;&amp;\text{(Val Unfold)} \\
&amp;\frac{\Gamma \vdash M:\lbrack \mu X.A/X\rbrack A}{\Gamma \vdash fold_{\mu X.A}M:\mu X.A} &amp;&amp; \frac{\Gamma \vdash M:\mu X.A}{\Gamma \vdash unfold_{\mu X.A/X}M:\lbrack \mu X.A/X\rbrack A}
\end{aligned}
\]</span></p>
<h5 id="list-type">List Type</h5>
<p>é€’å½’ç±»å‹çš„æ ‡å‡†åº”ç”¨å°±æ˜¯ç”¨æ¥å®šä¹‰<code>list</code>å’Œ<code>tree</code>ï¼Œç”šè‡³<code>product</code>å’Œ<code>union</code>ç±»å‹ã€‚ <span class="math display">\[
\begin{aligned}
&amp;List_A  \qquad \triangleq \qquad \mu X.Unit+(A\times X) \\
&amp;nil_A:List_A \triangleq \qquad fold(inLeft\ unit)\\
&amp;cons_A:A\to List_A \to List_A \qquad \triangleq \qquad \lambda hd:A.\lambda tl:List_A.fold(inRight\langle hd.tl\rangle)\\
&amp;listCase_{A,B}:List_A \to B \to (A\times List_A \to B) \to B \triangleq \\
&amp;\lambda l:List_A.\lambda n:B. \lambda c:A \times List_A \to B \\
&amp; case(unfold\ l) of \ unit:\ Unit\ then\ n| p:A\times List_A\ then\ c\ p
\end{aligned}
\]</span> <code>Recursive Type</code>å¯ä»¥å’Œ<code>Record Type and Variant Type</code>ä¸€èµ·å®šèƒ½å¤Ÿä»¥æ›´åŠ å¤æ‚çš„æ ‘ç»“æ„æ¯”å¦‚<code>abstract syntax trees</code>ã€‚è€Œ<code>case/with</code>è¯­å¥å°±å¯ä»¥è¢«ç”¨æ¥è§£æè¿™äº›æ ‘ç»“æ„ã€‚</p>
<p>å½“å’Œå‡½æ•°ç±»å‹è”åˆä½¿ç”¨çš„æ—¶å€™ï¼Œé€’å½’ç±»å‹å˜çš„æ›´åŠ å¼ºå¤§ã€‚<font color="blue">Via clever encodings, one can show that recursion at the value level is already implicit in recursive types: there is no need to introduce recursion as a separate construct.</font> è€Œä¸”ékç±»å‹è®¡ç®—åœ¨<code>typed languages</code>ä¸­æ‰§è¡Œäº†-<font color="blue">More precisely, Table 18 shows how to define, for any type A, a divergent element A of that type, and a fixpoint operator A for that type. </font></p>
<p>æœ€åï¼Œ<code>Type equivalence</code>åœ¨é€’å½’ç±»å‹ä¸­æ˜¾å¾—æ›´åŠ æœ‰éš¾åº¦ã€‚</p>
<h3 id="advanced">Advanced</h3>
<h4 id="first-order-type-systems-for-imperative-languages">First-order Type Systems for Imperative Languages</h4>
<p><font color="orange">Imperative languages have a slightly different style of type systems, mostly because they distinguish commands, which do not produce values, from expressions, which do produce values</font>äº§ç”Ÿ<code>side effect</code>?</p>
<h4 id="second-order-type-systems">Second-order Type Systems</h4>
<p><code>Type parameter</code>æ¶µç›–æ³›å‹ï¼Œç±»ï¼Œæ¥å£ï¼Œæ¨¡æ¿(C++)ç­‰é«˜çº§ä¸»é¢˜ã€‚</p>
<h4 id="subtyping">SubTyping</h4>
<p>é’ˆå¯¹é¢å‘å¯¹è±¡ã€‚</p>
<h4 id="equivalence">Equivalence</h4>
<p>å¤æ‚æƒ…å†µä¸‹é‡æ„ç±»å‹ç›¸ç­‰ã€‚</p>
<h4 id="type-inference">Type inference</h4>
<p>ç»Ÿç­¹ç±»å‹æ¨å¯¼ã€‚</p>
<h4 id="æš‚æ—¶æ€»ç»“">æš‚æ—¶æ€»ç»“</h4>
<p><a href="http://lucacardelli.name/papers/typesystems.pdf" target="_blank" rel="noopener">æœ¬ç‰‡è®ºæ–‡</a>å¯¹ç±»å‹ç³»ç»Ÿåšäº†å…¨èŒƒå›´çš„ç»¼è¿°ï¼Œè¿›ä¸€æ­¥æ·±å…¥è¿˜éœ€è¦ä¸€äº›åŸºç¡€ã€‚TODO:)</p>
<h4 id="å‚è€ƒ">å‚è€ƒ</h4>
<p><a href="https://opendsa-server.cs.vt.edu/OpenDSA/Books/PL/html/FreeBoundVariables.html" target="_blank" rel="noopener">free/bound variables</a></p>

      
    </div>
    
    
    
    

    <div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JSåº“ sweetalert å¯ä¿®æ”¹è·¯å¾„ -->
  <script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2021/06/16/Type-system-a-Sketchy-view/">Type system, a Sketchy view.</a></p>
  <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="è®¿é—® HaotianMichael çš„ä¸ªäººåšå®¢">HaotianMichael</a></p>
  <p><span>å‘å¸ƒæ—¶é—´:</span>2021å¹´06æœˆ15æ—¥ - 18:06</p>
  <p><span>æœ€åæ›´æ–°:</span>2022å¹´03æœˆ21æ—¥ - 05:03</p>
  <p><span>åŸå§‹é“¾æ¥:</span><a href="/2021/06/16/Type-system-a-Sketchy-view/" title="Type system, a Sketchy view.">http://haotianmcihael.github.io/2021/06/16/Type-system-a-Sketchy-view/</a>
    <span class="copy-path"  title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥"><i class="fa fa-clipboard" data-clipboard-text="http://haotianmcihael.github.io/2021/06/16/Type-system-a-Sketchy-view/"  aria-label="å¤åˆ¶æˆåŠŸï¼"></i></span>
  </p>
  <p><span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
    $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({   
          title: "",   
          text: 'å¤åˆ¶æˆåŠŸ',
          icon: "success", 
          showConfirmButton: true
          });
    });
    });  
</script>



      
   </div>	 

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/PL/" rel="tag"><i class="fa fa-tag"></i> PL</a>
          
            <a href="/tags/Type-System/" rel="tag"><i class="fa fa-tag"></i> Type System</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/06/06/NJUé™æ€ç¨‹åºåˆ†æ-5-IFDS/" rel="next" title="NJUé™æ€ç¨‹åºåˆ†æ(5-IFDS-And-Soundiness)">
                <i class="fa fa-chevron-left"></i> NJUé™æ€ç¨‹åºåˆ†æ(5-IFDS-And-Soundiness)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/06/27/Advanced-Compiler-Design-and-Implementation/" rel="prev" title="Advanced Compiler Design and Implementation">
                Advanced Compiler Design and Implementation <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="HaotianMichael" />
          <p class="site-author-name" itemprop="name">HaotianMichael</p>
           
              <p class="site-description motion-element" itemprop="description">Under The Hood</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/haotianmichael" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.cnblogs.com/haotianmichael" target="_blank" title="Cnblogs">
                  
                    <i class="fa fa-fw fa-address-book"></i>
                  
                    
                      Cnblogs
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/mikehaotian" target="_blank" title="Zhihu">
                  
                    <i class="fa fa-fw fa-comment"></i>
                  
                    
                      Zhihu
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#abstract"><span class="nav-number">1.</span> <span class="nav-text">Abstract</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#introduction"><span class="nav-number">2.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#execution-errors"><span class="nav-number">2.1.</span> <span class="nav-text">Execution errors</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#safety"><span class="nav-number">2.1.1.</span> <span class="nav-text">safety</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#well-behaved"><span class="nav-number">2.1.2.</span> <span class="nav-text">well-behaved</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#safety-or-performance"><span class="nav-number">2.1.3.</span> <span class="nav-text">safety or Performance</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#typed-and-untyped-languages"><span class="nav-number">2.2.</span> <span class="nav-text">Typed and untyped languages</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#properties-of-type-systems"><span class="nav-number">2.2.1.</span> <span class="nav-text">properties of type systems</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#how-type-systems-are-formalized"><span class="nav-number">2.3.</span> <span class="nav-text">How type systems are formalized</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#type-and-term"><span class="nav-number">2.3.1.</span> <span class="nav-text">type and term</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#scoping-rules"><span class="nav-number">2.3.2.</span> <span class="nav-text">scoping rules</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#type-rules"><span class="nav-number">2.3.3.</span> <span class="nav-text">type rules</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#static-typing-environments"><span class="nav-number">2.3.4.</span> <span class="nav-text">static typing environments</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#semantics"><span class="nav-number">2.3.5.</span> <span class="nav-text">semantics</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#type-equivalence"><span class="nav-number">2.4.</span> <span class="nav-text">Type equivalence</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-language-of-type-systems"><span class="nav-number">3.</span> <span class="nav-text">The language of type systems</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#judgements"><span class="nav-number">3.1.</span> <span class="nav-text">Judgements</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#type-rules-1"><span class="nav-number">3.2.</span> <span class="nav-text">Type rules</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#type-derivations"><span class="nav-number">3.3.</span> <span class="nav-text">Type derivations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#well-typing-and-type-inference"><span class="nav-number">3.4.</span> <span class="nav-text">Well typing and type inference</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#type-soundness"><span class="nav-number">3.5.</span> <span class="nav-text">Type soundness</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#first-order-type-systems"><span class="nav-number">4.</span> <span class="nav-text">First-order Type Systems</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#syntax-of-f1"><span class="nav-number">4.1.</span> <span class="nav-text">Syntax of F1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#basic-of-f1"><span class="nav-number">4.2.</span> <span class="nav-text">Basic of F1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#expansion-of-f1"><span class="nav-number">4.3.</span> <span class="nav-text">Expansion of F1</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#unit-type"><span class="nav-number">4.3.1.</span> <span class="nav-text">Unit Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#bool-type"><span class="nav-number">4.3.2.</span> <span class="nav-text">Bool Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#nat-type"><span class="nav-number">4.3.3.</span> <span class="nav-text">Nat Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#product-type"><span class="nav-number">4.3.4.</span> <span class="nav-text">Product Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#union-type"><span class="nav-number">4.3.5.</span> <span class="nav-text">Union Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#record-type"><span class="nav-number">4.3.6.</span> <span class="nav-text">Record Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#variant-type"><span class="nav-number">4.3.7.</span> <span class="nav-text">Variant Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#reference-type"><span class="nav-number">4.3.8.</span> <span class="nav-text">Reference Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#array-type"><span class="nav-number">4.3.9.</span> <span class="nav-text">Array Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#recursive-type"><span class="nav-number">4.3.10.</span> <span class="nav-text">Recursive Type</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#list-type"><span class="nav-number">4.3.11.</span> <span class="nav-text">List Type</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#advanced"><span class="nav-number">5.</span> <span class="nav-text">Advanced</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#first-order-type-systems-for-imperative-languages"><span class="nav-number">5.1.</span> <span class="nav-text">First-order Type Systems for Imperative Languages</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#second-order-type-systems"><span class="nav-number">5.2.</span> <span class="nav-text">Second-order Type Systems</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#subtyping"><span class="nav-number">5.3.</span> <span class="nav-text">SubTyping</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#equivalence"><span class="nav-number">5.4.</span> <span class="nav-text">Equivalence</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#type-inference"><span class="nav-number">5.5.</span> <span class="nav-text">Type inference</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æš‚æ—¶æ€»ç»“"><span class="nav-number">5.6.</span> <span class="nav-text">æš‚æ—¶æ€»ç»“</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å‚è€ƒ"><span class="nav-number">5.7.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        

<div class="copyright" >
     
  <span class="author" itemprop="copyrightHolder">HaotianMichael</span>
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
 
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
